<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Perform a test of the shared space-environment fraction of a variation partitioning using torus-translation (TT) or Moran Spectral Randomisation (MSR) — envspace.test • adespatial</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Perform a test of the shared space-environment fraction of a variation partitioning using torus-translation (TT) or Moran Spectral Randomisation (MSR) — envspace.test"><meta property="og:description" content="The function uses two different spatially-constrained null models to test the shared
space-environment fraction (SSEF, or fraction [b]) of a variation partitioning of two
explanatory components."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-23</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/adeverse/adespatial/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform a test of the shared space-environment fraction of a variation partitioning using torus-translation (TT) or Moran Spectral Randomisation (MSR)</h1>
    <small class="dont-index">Source: <a href="https://github.com/adeverse/adespatial/blob/master/R/envspace.test.R" class="external-link"><code>R/envspace.test.R</code></a></small>
    <div class="hidden name"><code>envspace.test.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The function uses two different spatially-constrained null models to test the shared
space-environment fraction (SSEF, or fraction [b]) of a variation partitioning of two
explanatory components.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">envspace.test</span><span class="op">(</span></span>
<span>  <span class="va">spe</span>,</span>
<span>  <span class="va">env</span>,</span>
<span>  <span class="va">coord</span>,</span>
<span>  <span class="va">MEM.spe</span>,</span>
<span>  <span class="va">listw.env</span>,</span>
<span>  MEM.autocor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"positive"</span>, <span class="st">"negative"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  regular <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nperm <span class="op">=</span> <span class="fl">999</span>,</span>
<span>  MSR.method <span class="op">=</span> <span class="st">"singleton"</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-spe">spe<a class="anchor" aria-label="anchor" href="#arg-spe"></a></dt>
<dd><p>Vector, matrix, or dataframe of response variable(s) (e.g. species abundances)</p></dd>


<dt id="arg-env">env<a class="anchor" aria-label="anchor" href="#arg-env"></a></dt>
<dd><p>Vector, matrix, or dataframe of environmental variables (rows = sites,
columns = variables)</p></dd>


<dt id="arg-coord">coord<a class="anchor" aria-label="anchor" href="#arg-coord"></a></dt>
<dd><p>Matrix or dataframe of spatial coordinates of the sampled sites</p></dd>


<dt id="arg-mem-spe">MEM.spe<a class="anchor" aria-label="anchor" href="#arg-mem-spe"></a></dt>
<dd><p>Matrix or dataframe of spatial predictors (MEM variables) selected for
<code>spe</code></p></dd>


<dt id="arg-listw-env">listw.env<a class="anchor" aria-label="anchor" href="#arg-listw-env"></a></dt>
<dd><p>An object of class <code>listw</code> (spatial weights) created by the functions
of the <code>spdep</code> package or returned by <code><a href="listw.candidates.html">listw.candidates</a></code></p></dd>


<dt id="arg-mem-autocor">MEM.autocor<a class="anchor" aria-label="anchor" href="#arg-mem-autocor"></a></dt>
<dd><p>A string indicating the type of spatial structure of interest for
<code>env</code> (<code>"positive"</code>, <code>"negative"</code>, or <code>"all"</code>, for positive, negative,
or both types of spatial autocorrelations, respectively); Default is <code>"positive"</code></p></dd>


<dt id="arg-regular">regular<a class="anchor" aria-label="anchor" href="#arg-regular"></a></dt>
<dd><p>Logical argument indicating whether a torus-translation test will be
performed, in addition to the MSR. Set to <code>TRUE</code> only if the sampling design is regular
(same number of sites on each line, same number of sites on each column). Set to
<code>FALSE</code> otherwise; Default is <code>FALSE</code></p></dd>


<dt id="arg-nperm">nperm<a class="anchor" aria-label="anchor" href="#arg-nperm"></a></dt>
<dd><p>Number of permutations performed; Default is 999</p></dd>


<dt id="arg-msr-method">MSR.method<a class="anchor" aria-label="anchor" href="#arg-msr-method"></a></dt>
<dd><p>Algorithm of <code><a href="msr.html">msr</a></code> to be used to perform the MSR. The
three available procedures are <code>"singleton"</code> (default), <code>"pair"</code>, and
<code>"triplet"</code> (see <code><a href="msr.html">msr</a></code> for details)</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Threshold value of null hypothesis rejection for the test of a
spatial structure in the environment, and for the shared environment-space fraction of
the variation partitioning; Default is 0.05</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>If the condition of <code>env</code> being spatially structured is fulfilled, the test
is performed and the function returns an object of class <code>randtest</code> containing the results of the test.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function tests the SSEF (also known as fraction [b]) of a variation
partitioning of a response variable or matrix (<code>y</code>) between an environmental and a
spatial component (<code>env</code>, and <code>MEM.spe</code>, respectively). The SSEF is the
explained variation of <code>y</code> shared by <code>env</code> and <code>MEM.spe</code>.
The adjusted R-squared (Peres-Neto et al. 2006; R2adj) of the SSEF is not an
actual R2, as it is computed by subtracting the adjusted R2adj of other fractions and
therefore has zero degree of freedom (Legendre and Legendre 2012).
The SSEF can therefore not be computed in the classical way (residuals permutation;
Anderson and Legendre 1999, Legendre and Legendre 2012).</p>
<p>The function <code>envspace.test</code> provides two ways of testing this fraction, that is,
spatially-constrained null models based either on a torus-translation test (TT) (for
regular sampling designs only), or on Moran spectral randomizations (MSR) (for any type
of sampling design). The test of the SSEF should only be performed if both the global
models of <code>y</code> against all the environmental variables and against all spatial variables
are significant (see Bauman et al. 2018c).
The function first checks whether the environment displays significant spatial structures,
and then proceeds to the test of the SSEF if this condition is fulfilled (details in
Bauman et al. 2018c).</p>
<p><code>spe</code> can be a vector or a multicolumn matrix or dataframe (multivariate
response data). If multivariate, it is greatly advised to transform <code>spe</code> prior
to performing the variation partitioning and testing the SSEF (e.g., Hellinger
transformation; see Legendre and Gallagher 2001).</p>
<p><code>MEM.spe</code> is a set of spatial predictors (MEM variables). It is recommended to be
a well-defined subset of MEM variables selected among the complete set generated from
the spatial weighting matrix (SWM) (see review about spatial eigenvector selection in
Bauman et al. 2018a).
Optimising the selection of a subset of forward-selected MEM variables
among a set of candidate SWMs has been shown to increase statistical power as well as
R2-estimation accuracy (Bauman et al. 2018b). To do so, <code>MEM.spe</code> can be generated
using <code><a href="listw.candidates.html">listw.candidates</a></code> followed by <code><a href="listw.select.html">listw.select</a></code>. If a SWM has
already been selected in another way, then <code><a href="mem.select.html">mem.select</a></code> can be used to
generate the MEM variables and to select an optimal subset among them, which can then
be used as <code>MEM.spe</code> in <code>envspace.test</code> (see <code>Details</code> of function
<code>mem.select</code>).
<code>listw.env</code> corresponds to the SWM that will be used to test for a spatial structure
in <code>env</code>, and to build the MEM variables for the MSR test.
The choice of the SWM for <code>env</code> can also be optimised with <code><a href="listw.select.html">listw.select</a></code>.
The SWMs selected for <code>spe</code> and <code>env</code> should be optimised separately to
best model the spatial structure of both <code>spe</code> and <code>env</code> (see example).</p>
<p>To verify that <code>env</code> displays a significant spatial pattern, prior to performing the
test of the SSEF, a residuals permutation test is performed on the global set of MEM
variables (generated internally from <code>listw.env</code>) associated to the type of
spatial structure of interest (see argument <code>MEM.autocor</code>). This test is performed
with <code>mem.select</code>. The choice of <code>MEM.autocor</code> should be made according to
the <code>MEM.autocor</code> argument used to build <code>MEM.spe</code>.</p>
<p><code>env</code> is a dataset of environmental variables chosen by the user. We recommend dealing
with collinearity issues prior to performing the variation partitioning and the test of
the SSEF (see Dormann et al. 2013 for a review of methods to cope with collinearity).</p>
<p><code>regular</code> is a logical argument indicating whether a TT test should
be performed instead of the MSR to test the SSEF. Since the TT can only
be performed on regular sampling designs, <code>regular</code> should only be set to
<code>TRUE</code> if the sampling design is either a transect, or a grid displaying the
same number of sites for all lines and columns (although the number of sites per column
can differ from the number of sites per line).</p>
<p><code>listw.env</code> is the SWM used by the MSR to generate spatially-constrained null
environmental variables. It should ideally be a SWM optimised on the basis of <code>env</code>
using the function <code>listw.select</code>, with the argument <code>method = "global"</code> (see
<code>Details</code> of function <code>mem.select</code> for an explanation).
This will allow detecting the spatial structures of <code>env</code> as accurately as possible,
hence allowing MSR to generate null environmental variables as spatially faithful to the
original ones.
It is also on the basis of <code>listw.env</code> that MEM variables will be generated to test
whether <code>env</code> is spatially structured (i.e. global test) prior to perform the test of
the SSEF.</p>
<p>It is worth mentioning that, although a significant SSEF may provide evidence of an
induced spatial dependence (Bauman et al. 2018c), a non-significant SSEF only indicates
that no induced spatial dependence could be detected in relation with the chosen
environmental variables. This does not exclude that this effect may exist with respect
to some unmeasured variables.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Anderson M. and Legendre P. (1999) An empirical comparison of permutation
methods for tests of partial regression coefficients in a linear model. Journal of
Statistical Computation and Simulation, 62(3), 271–303</p>
<p>Bauman D., Drouet T., Dray S. and Vleminckx J. (2018a) Disentangling good
from bad practices in the selection of spatial or phylogenetic eigenvectors. Ecography,
41, 1–12</p>
<p>Bauman D., Fortin M-J, Drouet T. and Dray S. (2018b) Optimizing the choice
of a spatial weighting matrix in eigenvector-based methods. Ecology</p>
<p>Bauman D., Vleminckx J., Hardy O., Drouet T. (2018c) Testing and interpreting the
shared space-environment fraction in variation partitioning analyses of ecological data.
Oikos</p>
<p>Blanchet G., Legendre P. and Borcard D. (2008) Forward selection of explanatory variables.
Ecology, 89(9), 2623–2632</p>
<p>Legendre P., Gallagher E.D. (2001) Ecologically meaningful transformations for
ordination of species data. Oecologia, 129(2), 271–280</p>
<p>Legendre P. and Legendre L. (2012) Numerical Ecology, Elsevier, Amsterdam</p>
<p>Peres-Neto P., Legendre P., Dray S., Borcard D. (2006) Variation partitioning of
species data matrices: estimation and comparison of fractions. Ecology, 87(10),
2614–2625</p>
<p>Peres-Neto P. and Legendre P. (2010) Estimating and controlling for spatial structure
in the study of ecological communities. Global Ecology and Biogeography, 19, 174–184</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/vegan/man/varpart.html" class="external-link">varpart</a></code>, <code><a href="listw.select.html">listw.select</a></code>, <code><a href="listw.candidates.html">listw.candidates</a></code>, <code><a href="mem.select.html">mem.select</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>David Bauman and Jason Vleminckx, <a href="mailto:davbauman@gmail.com">davbauman@gmail.com</a>,
<a href="mailto:jasvlx86@gmail.com">jasvlx86@gmail.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan" class="external-link">vegan</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span> </span></span>
<span class="r-in"><span><span class="co"># Illustration of the test of the SSEF on the oribatid mite data</span></span></span>
<span class="r-in"><span><span class="co"># (Borcard et al. 1992, 1994 for details on the dataset):</span></span></span>
<span class="r-in"><span><span class="co"># Community data (response matrix):</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Hellinger-transformation of the community data (Legendre and Gallagher 2001):</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/decostand.html" class="external-link">decostand</a></span><span class="op">(</span><span class="va">mite</span>, method <span class="op">=</span> <span class="st">"hellinger"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Environmental explanatory dataset:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># We only use two numerical explanatory variables:</span></span></span>
<span class="r-in"><span><span class="va">env</span> <span class="op">&lt;-</span> <span class="va">mite.env</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">Y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Coordinates of the 70 sites:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite.xy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coord</span> <span class="op">&lt;-</span> <span class="va">mite.xy</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Building a list of candidate spatial weighting matrices (SWMs) for the </span></span></span>
<span class="r-in"><span><span class="co">### optimisation of the SWM selection, separately for 'Y' and 'env':</span></span></span>
<span class="r-in"><span><span class="co"># We create five candidate SWMs: a connectivity matrix based on a Gabriel graphs, on</span></span></span>
<span class="r-in"><span><span class="co"># a minimum spanning tree (i.e., two contrasted graph-based SWMs), either</span></span></span>
<span class="r-in"><span><span class="co"># not weighted, or weighted by a linear function decreasing with the distance),</span></span></span>
<span class="r-in"><span><span class="co"># and a distance-based SWM corresponding to the connectivity and weighting</span></span></span>
<span class="r-in"><span><span class="co"># criteria of the original PCNM method:</span></span></span>
<span class="r-in"><span><span class="va">candidates</span> <span class="op">&lt;-</span> <span class="fu"><a href="listw.candidates.html">listw.candidates</a></span><span class="op">(</span><span class="va">coord</span>, nb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gab"</span>, <span class="st">"mst"</span>, <span class="st">"pcnm"</span><span class="op">)</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"binary"</span>,</span></span>
<span class="r-in"><span>                                                                                <span class="st">"flin"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">### Optimisation of the selection of a SWM:</span></span></span>
<span class="r-in"><span><span class="co"># SWM for 'Y' (based on the best forward-selected subset of MEM variables):</span></span></span>
<span class="r-in"><span><span class="va">modsel.Y</span> <span class="op">&lt;-</span> <span class="fu"><a href="listw.select.html">listw.select</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">candidates</span>, method <span class="op">=</span> <span class="st">"FWD"</span>, MEM.autocor <span class="op">=</span> <span class="st">"positive"</span>,</span></span>
<span class="r-in"><span>                         p.adjust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>                         </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">candidates</span><span class="op">)</span><span class="op">[</span><span class="va">modsel.Y</span><span class="op">$</span><span class="va">best.id</span><span class="op">]</span>                 <span class="co"># Best SWM selected</span></span></span>
<span class="r-in"><span><span class="va">modsel.Y</span><span class="op">$</span><span class="va">candidates</span><span class="op">$</span><span class="va">Pvalue</span><span class="op">[</span><span class="va">modsel.Y</span><span class="op">$</span><span class="va">best.id</span><span class="op">]</span>        <span class="co"># Adjusted p-value of the global model</span></span></span>
<span class="r-in"><span><span class="va">modsel.Y</span><span class="op">$</span><span class="va">candidates</span><span class="op">$</span><span class="va">N.var</span><span class="op">[</span><span class="va">modsel.Y</span><span class="op">$</span><span class="va">best.id</span><span class="op">]</span>         <span class="co"># Nb of forward-selected MEM variables</span></span></span>
<span class="r-in"><span><span class="va">modsel.Y</span><span class="op">$</span><span class="va">candidates</span><span class="op">$</span><span class="va">R2Adj.select</span><span class="op">[</span><span class="va">modsel.Y</span><span class="op">$</span><span class="va">best.id</span><span class="op">]</span>  <span class="co"># Adjusted R2 of the selected MEM var.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SWM for 'env' (method = "global" for the optimisation, as all MEM variables are required</span></span></span>
<span class="r-in"><span><span class="co"># to use MSR):</span></span></span>
<span class="r-in"><span><span class="va">modsel.env</span> <span class="op">&lt;-</span> <span class="fu"><a href="listw.select.html">listw.select</a></span><span class="op">(</span><span class="va">env</span>, <span class="va">candidates</span>, method <span class="op">=</span> <span class="st">"global"</span>, MEM.autocor <span class="op">=</span> <span class="st">"positive"</span>,</span></span>
<span class="r-in"><span>                           p.adjust <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">candidates</span><span class="op">)</span><span class="op">[</span><span class="va">modsel.env</span><span class="op">$</span><span class="va">best.id</span><span class="op">]</span>                  <span class="co"># Best SWM selected</span></span></span>
<span class="r-in"><span><span class="va">modsel.env</span><span class="op">$</span><span class="va">candidates</span><span class="op">$</span><span class="va">Pvalue</span><span class="op">[</span><span class="va">modsel.env</span><span class="op">$</span><span class="va">best.id</span><span class="op">]</span>       <span class="co"># Adjusted p-value of the global model</span></span></span>
<span class="r-in"><span><span class="va">modsel.env</span><span class="op">$</span><span class="va">candidates</span><span class="op">$</span><span class="va">N.var</span><span class="op">[</span><span class="va">modsel.env</span><span class="op">$</span><span class="va">best.id</span><span class="op">]</span>        <span class="co"># Nb of forward-selected MEM variables</span></span></span>
<span class="r-in"><span><span class="va">modsel.env</span><span class="op">$</span><span class="va">candidates</span><span class="op">$</span><span class="va">R2Adj.select</span><span class="op">[</span><span class="va">modsel.env</span><span class="op">$</span><span class="va">best.id</span><span class="op">]</span> <span class="co"># Adjusted R2 of the selected MEM var.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### We perform the variation partitioning:</span></span></span>
<span class="r-in"><span><span class="co"># Subset of selected MEM variables within the best SWM:</span></span></span>
<span class="r-in"><span><span class="va">MEM.spe</span> <span class="op">&lt;-</span> <span class="va">modsel.Y</span><span class="op">$</span><span class="va">best</span><span class="op">$</span><span class="va">MEM.select</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">VP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vegan/man/varpart.html" class="external-link">varpart</a></span><span class="op">(</span><span class="va">Y</span>, <span class="va">env</span>, <span class="va">MEM.spe</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">VP</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test of the shared space-environment fraction (fraction [b]):</span></span></span>
<span class="r-in"><span><span class="va">SSEF.test</span> <span class="op">&lt;-</span> <span class="fu">envspace.test</span><span class="op">(</span><span class="va">Y</span>, <span class="va">env</span>, <span class="va">coord</span>, <span class="va">MEM.spe</span>, </span></span>
<span class="r-in"><span>                           listw.env <span class="op">=</span> <span class="va">candidates</span><span class="op">[[</span><span class="va">modsel.env</span><span class="op">$</span><span class="va">best.id</span><span class="op">]</span><span class="op">]</span>, </span></span>
<span class="r-in"><span>                           regular <span class="op">=</span> <span class="cn">FALSE</span>, nperm <span class="op">=</span> <span class="fl">999</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">SSEF.test</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The SSEF is highly significant, indicating a potential induced spatial dependence.</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>zero sum general weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Procedure stopped (adjR2thresh criteria) adjR2cum = 0.452381 with 11 variables (&gt; 0.446534)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Procedure stopped (alpha criteria): pvalue for variable 14 is 0.072000 (&gt; 0.050000)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Procedure stopped (alpha criteria): pvalue for variable 14 is 0.098000 (&gt; 0.050000)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Procedure stopped (alpha criteria): pvalue for variable 13 is 0.061000 (&gt; 0.050000)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Procedure stopped (alpha criteria): pvalue for variable 12 is 0.061000 (&gt; 0.050000)</span>
<span class="r-plt img"><img src="envspace.test-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Monte-Carlo test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: as.randtest(sim = E.b, obs = R2.b, alter = alternative)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observation: 0.21545 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Based on 999 replicates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated p-value: 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alternative hypothesis: greater </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Std.Obs Expectation    Variance </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -2.94921170  0.41168982  0.00442754 </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stéphane Dray, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

