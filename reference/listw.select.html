<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Function to optimize the selection of a spatial weighting matrix and select the best subset of eigenvectors (MEM, Moran's Eigenvector Maps) — listw.select • adespatial</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Function to optimize the selection of a spatial weighting matrix and select the best subset of eigenvectors (MEM, Moran's Eigenvector Maps) — listw.select"><meta property="og:description" content="listw.select computes MEM variables (i.e., eigenvectors of a doubly
centered spatial weighting matrix) for various definitions of spatial
weighting matrices (SWM) and optimizes the selection of the SWM and of a
subset of MEM variables. The optimization is done by maximizing the adjusted
R-squared (R2) or by minimizing the residual spatial autocorrelation. The
function controls the type I error rate by accounting for the number of tests
performed. This function combine calls to the functions scores.listw and
mem.select. The list of candidate SWMs
can easily be generated using listw.candidates."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-24</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/adeverse/adespatial/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Function to optimize the selection of a spatial weighting matrix and select the best subset of eigenvectors (MEM, Moran's Eigenvector Maps)</h1>
    <small class="dont-index">Source: <a href="https://github.com/adeverse/adespatial/blob/master/R/listw.select.R" class="external-link"><code>R/listw.select.R</code></a></small>
    <div class="hidden name"><code>listw.select.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>listw.select</code> computes MEM variables (i.e., eigenvectors of a doubly
centered spatial weighting matrix) for various definitions of spatial
weighting matrices (SWM) and optimizes the selection of the SWM and of a
subset of MEM variables. The optimization is done by maximizing the adjusted
R-squared (R2) or by minimizing the residual spatial autocorrelation. The
function controls the type I error rate by accounting for the number of tests
performed. This function combine calls to the functions <code>scores.listw</code> and
<code>mem.select</code>. The list of candidate SWMs
can easily be generated using <code><a href="listw.candidates.html">listw.candidates</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">listw.select</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">candidates</span>,</span>
<span>  MEM.autocor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"positive"</span>, <span class="st">"negative"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FWD"</span>, <span class="st">"MIR"</span>, <span class="st">"global"</span><span class="op">)</span>,</span>
<span>  MEM.all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nperm <span class="op">=</span> <span class="fl">999</span>,</span>
<span>  nperm.global <span class="op">=</span> <span class="fl">9999</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  p.adjust <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Vector, matrix, or dataframe of the response variable(s)</p></dd>


<dt id="arg-candidates">candidates<a class="anchor" aria-label="anchor" href="#arg-candidates"></a></dt>
<dd><p>A list of SWMs of the class <code>listw</code>;
<code>candidates</code> can be created by <code>listw.candidates</code></p></dd>


<dt id="arg-mem-autocor">MEM.autocor<a class="anchor" aria-label="anchor" href="#arg-mem-autocor"></a></dt>
<dd><p>Sign of the spatial eigenvectors to generate; <code>"positive"</code>,
<code>"negative"</code>, or <code>"all"</code>, for positively, negatively autocorrelated
eigenvectors, or both, respectively; default is <code>"positive"</code></p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Criterion to select the best subset of MEM variables. Either
<code>forward</code> (default option), <code>"MIR"</code> (for univariate <code>x</code>
only), or <code>"global"</code> (see <code>Details</code>)</p></dd>


<dt id="arg-mem-all">MEM.all<a class="anchor" aria-label="anchor" href="#arg-mem-all"></a></dt>
<dd><p>A logical indicating if the complete set of MEM variables for the best model
should be returned</p></dd>


<dt id="arg-nperm">nperm<a class="anchor" aria-label="anchor" href="#arg-nperm"></a></dt>
<dd><p>Number of permutations to perform the tests in the selection
procedure; Default is 999</p></dd>


<dt id="arg-nperm-global">nperm.global<a class="anchor" aria-label="anchor" href="#arg-nperm-global"></a></dt>
<dd><p>Number of permutations to perform the tests in the global test;
Default is 9999</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Significance threshold value for the tests; Default is 0.05</p></dd>


<dt id="arg-p-adjust">p.adjust<a class="anchor" aria-label="anchor" href="#arg-p-adjust"></a></dt>
<dd><p>A logical indicating wheter the p-value of the global test performed on each SWM
should be corrected for multiple tests (TRUE) or not (FALSE); default is
<code>TRUE</code></p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If 'TRUE' more diagnostics are printed. The default setting is
FALSE</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p><code>listw.select</code> returns a list that contains:</p><dl><dt>candidates</dt>
<dd><p>A data.frame that summarizes the results on all SWMs</p></dd>

 <dt>best.id</dt>
<dd><p>The index and name of the best SWM</p></dd>
 <dt>best</dt>
<dd><p>The results
 for the best SWM as returned by <code>mem.select</code></p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>While the selection of the SWM is the most critical step of the
 spatial eigenvector-based methods (Dray et al. 2006), Bauman et al. (2018)
 showed that optimizing the choice of the SWM led to inflated type I error
 rates if an explicit control of the number of SWMs tested was not applied.
 The function <code>listw.select</code> therefore applies a Sidak correction (Sidak
 1967) for multiple tests to the p-value of the global test of each SWM
 (i.e., the model integrating the whole set of spatial predictors). The Sidak
 correction is computed as: \(P_corrected = 1 - (1 - P)^n\), where \(n\)
 is the number of tests performed, \(P\) is the observed p-value, and
 \(P_corrected\) is the new p-value after the correction. The p-value is
 first computed using <code>nperm</code> permutations and then corrected according to
 the total number of SWMs tested (if <code>p.adjust = TRUE</code>). Although the
 function can be run without this correction, using the default value is strongly
 recommended to avoid inflated type I error rates (Bauman et al. 2018).</p>
<p>As a consequence of the p-value correction, the significance threshold decreases
 as the number of SWMs increases, hence leading to a trade-off between the gain of
 accuracy and the power loss.</p>
<p>The optimization criterion of the SWM performed by <code>listw.select</code> is
 either based on the maximization of the significant adjusted R2 of all the generated
 spatial eigenvectors (also referred to as spatial predictors or MEM
 variables) (<code>method = "global"</code>), or is based on an optimized subset of
 eigenvectors (<code>method = "FWD"</code> and <code>"MIR"</code>).</p>
<p>If the objective is only to optimize the selection of the SWM, without the
 intervention of the selection of a subset of predictors within each SWM
 (<code>method = "global"</code>), then the best SWM is the one maximizing the significant adjusted
 global R2, that is, the R2 of the model of <code>x</code> against the whole set of
 generated MEM variables which must be significant for the global test (<code>method = "global"</code>).</p>
<p>The optimization of the SWM depends on the choosen <code>method</code>. See
 <code><a href="mem.select.html">mem.select</a></code> for a description of the situations in which
 <code>method = "FWD"</code>, <code>"MIR"</code>, and <code>"global"</code> should be preferred.</p>
<p>If a subset of MEM variables is needed, then the optimization of the subset
 of spatial predictors guides the optimization of the selection of SWM
 (<code>method = "FWD"</code> or <code>"MIR"</code>).
 If <code>method = "FWD"</code>, <code>listw.select</code> performs the forward
 selection on the significant SWMs and selects among these the SWM for which
 the forward-selected subset of spatial eigenvectors yields the highest
 adjusted R2. If <code>method = "MIR"</code>, <code>listw.select</code> performs the MIR
 selection on all the significant candidate SWMs, and selects the best SWM as
 the one with the smallest number of MIR-selected spatial eigenvectors. If
 two or more SWMs present the same smallest number of predictors, then the
 selection is made among them on the basis of the residual Moran's I.
 If <code>MEM.autocor = "all"</code>, the optimization criteria described above are
 applied on the sum of the adjusted R2 or number of selected spatial eigenvectors,
 for <code>method = "FWD"</code> and <code>"MIR"</code>, respectively.
 If no subset of MEM variable is required, then the optimization of the SWM is
 based on the maximization of the adjusted R2 of all the generated MEM variables
 (<code>method = "global"</code>).</p>
<p>If <code>MEM.autocor = "all"</code>, n-1 MEM variables are generated. In this case, if
 <code>method = "global"</code> or <code>method = "FWD"</code>, the adjusted R2 is computed
 separately on the MEM associated to positive and negative eigenvalues (hereafter
 positive and negative MEM variables, respectively), and the SWM yielding the
 highest sum of the the two significant R2 values is selected. If <code>method = "MIR"</code>, the
 MIR selection is performed separately on the positive and negative MEM variables,
 and the SWM is selected based on the sum of the number of positive and
 negative spatial predictors.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Bauman D., Fortin M-J, Drouet T. and Dray S. (2018) Optimizing
 the choice of a spatial weighting matrix in eigenvector-based methods.
 Ecology</p>
<p>Blanchet G., Legendre P. and Borcard D. (2008) Forward selection of
 explanatory variables. Ecology, 89(9), 2623–2632</p>
<p>Dray S., Legendre P. and Peres-Neto P. R. (2006) Spatial modeling: a
 comprehensive framework for principal coordinate analysis of neighbor
 matrices (PCNM). Ecological Modelling, 196, 483–493</p>
<p>Sidak Z. (1967) Rectangular confidence regions for the means of multivariate
 normal distributions. Journal of the American Statistical Association,
 62(318), 626–633</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="listw.candidates.html">listw.candidates</a></code>, <code><a href="mem.select.html">mem.select</a></code>,
 <code><a href="mem.html">scores.listw</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Bauman David (<a href="mailto:dbauman@ulb.ac.be">dbauman@ulb.ac.be</a> or
 <a href="mailto:davbauman@gmail.com">davbauman@gmail.com</a>) and Stéphane Dray</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/" class="external-link">spdep</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">### Create a grid of 15 x 15:</span></span></span>
<span class="r-in"><span><span class="va">grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">15</span>, <span class="fl">1</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">15</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">### Generate a response variable Y structured at broad scale by linear combination of</span></span></span>
<span class="r-in"><span><span class="co">### the first three MEM variables to which a normal noise is added:</span></span></span>
<span class="r-in"><span><span class="va">nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/cell2nb.html" class="external-link">cell2nb</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">15</span>, ncol <span class="op">=</span> <span class="fl">15</span>, <span class="st">"queen"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">nb</span>, style <span class="op">=</span> <span class="st">"B"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">MEM</span> <span class="op">&lt;-</span> <span class="fu"><a href="mem.html">scores.listw</a></span><span class="op">(</span><span class="va">lw</span>, MEM.autocor <span class="op">=</span> <span class="st">"positive"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Degree of spatial autocorrelation:</span></span></span>
<span class="r-in"><span><span class="va">intensity</span> <span class="op">&lt;-</span> <span class="fl">0.8</span></span></span>
<span class="r-in"><span><span class="va">Y_space</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="va">MEM</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">MEM</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">MEM</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="va">intensity</span></span></span>
<span class="r-in"><span><span class="va">Y_noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/scale.html" class="external-link">scale</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">MEM</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">intensity</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">Y_space</span> <span class="op">+</span> <span class="va">Y_noise</span></span></span>
<span class="r-in"><span><span class="co">### Y is sampled in 100 randomly-chosen sites of the grid:</span></span></span>
<span class="r-in"><span><span class="va">idx.sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">grid</span><span class="op">)</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="va">grid</span><span class="op">[</span><span class="va">idx.sample</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">Y_sampled</span> <span class="op">&lt;-</span> <span class="va">Y</span><span class="op">[</span><span class="va">idx.sample</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co">### The function listw.candidates is used to build the spatial weighting matrices that</span></span></span>
<span class="r-in"><span><span class="co">### we want to test and compare (with the listw.select function). We test a Gabriel's graph,</span></span></span>
<span class="r-in"><span><span class="co">### a minimum spanning tree, and a distance-based connectivity defined by a threshold</span></span></span>
<span class="r-in"><span><span class="co">### distance corresponding to the smallest distance keeping all sites connected (i.e.,</span></span></span>
<span class="r-in"><span><span class="co">### the defaut value of d2; see help of function listw.candidates).</span></span></span>
<span class="r-in"><span><span class="co">### These connectivity matrices are then either not weighted (binary weighting), or</span></span></span>
<span class="r-in"><span><span class="co">### weighted by the linearly decreasing function (see help of the function listw.candidates):</span></span></span>
<span class="r-in"><span><span class="va">candidates</span> <span class="op">&lt;-</span> <span class="fu"><a href="listw.candidates.html">listw.candidates</a></span><span class="op">(</span>coord <span class="op">=</span> <span class="va">xy</span>, nb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gab"</span>, <span class="st">"mst"</span><span class="op">)</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"binary"</span>, <span class="st">"flin"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">### Number of candidate W matrices generated:</span></span></span>
<span class="r-in"><span><span class="va">nbw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">candidates</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">### Significance threshold value after p-value correction (Sidak correction):</span></span></span>
<span class="r-in"><span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="va">nbw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">### Optimization of the selection of the SWM among the candidates generated above,</span></span></span>
<span class="r-in"><span><span class="co">### using the corrected significance threshold calculated above for the global tests:</span></span></span>
<span class="r-in"><span><span class="va">W_sel</span> <span class="op">&lt;-</span> <span class="fu">listw.select</span><span class="op">(</span><span class="va">Y_sampled</span>, <span class="va">candidates</span>, MEM.autocor <span class="op">=</span> <span class="st">"positive"</span>, method <span class="op">=</span> <span class="st">"FWD"</span>,</span></span>
<span class="r-in"><span>                    p.adjust <span class="op">=</span> <span class="cn">TRUE</span>, nperm <span class="op">=</span> <span class="fl">299</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">### Some characteristics of the best spatial model:</span></span></span>
<span class="r-in"><span><span class="co"># Best SWM:</span></span></span>
<span class="r-in"><span><span class="va">W_sel</span><span class="op">$</span><span class="va">best.id</span></span></span>
<span class="r-in"><span><span class="co"># Selected subset of spatial predictor within the best SWM:</span></span></span>
<span class="r-in"><span><span class="va">W_sel</span><span class="op">$</span><span class="va">best</span><span class="op">$</span><span class="va">MEM.select</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">W_sel</span><span class="op">$</span><span class="va">best</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Corrected p-value of the global test of the best SWM:</span></span></span>
<span class="r-in"><span><span class="va">W_sel</span><span class="op">$</span><span class="va">best</span><span class="op">$</span><span class="va">global.test</span><span class="op">$</span><span class="va">Pvalue</span></span></span>
<span class="r-in"><span><span class="co"># Adjusted R2 of the subset of spatial predictors selected within the chosen SWM:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">W_sel</span><span class="op">$</span><span class="va">best</span><span class="op">$</span><span class="va">summary</span><span class="op">$</span><span class="va">R2Adj</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># p-values of all the tested W matrices:</span></span></span>
<span class="r-in"><span><span class="va">W_sel</span><span class="op">$</span><span class="va">candidates</span><span class="op">$</span><span class="va">Pvalue</span></span></span>
<span class="r-in"><span><span class="co"># Adjusted R2 of the subset of spatial predictors selected for all the significant</span></span></span>
<span class="r-in"><span><span class="co"># W matrices:</span></span></span>
<span class="r-in"><span><span class="va">W_sel</span><span class="op">$</span><span class="va">candidates</span><span class="op">$</span><span class="va">R2Adj.select</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># See Appendix S3 of Bauman et al. 2018 for more extensive examples and illustrations.</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>zero sum general weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Procedure stopped (adjR2thresh criteria) adjR2cum = 0.891150 with 6 variables (&gt; 0.885452)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Procedure stopped (adjR2thresh criteria) adjR2cum = 0.923635 with 10 variables (&gt; 0.920299)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Procedure stopped (adjR2thresh criteria) adjR2cum = 0.911589 with 17 variables (&gt; 0.909435)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Procedure stopped (alpha criteria): pvalue for variable 15 is 0.076667 (&gt; 0.050000)</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to max; returning -Inf</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8756144 0.9185877 0.9084881 0.8688357</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stéphane Dray, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

