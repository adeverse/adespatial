<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Moran spectral randomization for fourth-corner analysis — msr.4thcorner • adespatial</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Moran spectral randomization for fourth-corner analysis — msr.4thcorner" />
<meta property="og:description" content="This function allows to test fourth-corner statistics using constrained null
models (for traits and/or environmental variables). If the argument
phyloORorthobasis is specified, random traits are
phylogenetically-constrained to preserve the global autocorrelation (Moran's
I) and the phylogenetic structures at multiple scales. If not, standard
permutations are used. If the argument listwORorthobasis is specified,
random environmental variables are spatially-constrained to preserve the
global autocorrelation (Moran's I) and the spatial structures at multiple
scales. If not, standard permutations are used. Multiscale property is
defined by the power spectrum (i.e. decomposition of the variance of the
original variables) on a basis of orthonormal eigenvectors (Moran's
Eigenvector Maps, MEM)." />
<meta property="og:image" content="/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3-13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sdray/adespatial/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Moran spectral randomization for fourth-corner analysis</h1>
    <small class="dont-index">Source: <a href='https://github.com/sdray/adespatial/blob/master/R/msr.4thcorner.R'><code>R/msr.4thcorner.R</code></a></small>
    <div class="hidden name"><code>msr.4thcorner.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function allows to test fourth-corner statistics using constrained null
models (for traits and/or environmental variables). If the argument
<code>phyloORorthobasis</code> is specified, random traits are
phylogenetically-constrained to preserve the global autocorrelation (Moran's
I) and the phylogenetic structures at multiple scales. If not, standard
permutations are used. If the argument <code>listwORorthobasis</code> is specified,
random environmental variables are spatially-constrained to preserve the
global autocorrelation (Moran's I) and the spatial structures at multiple
scales. If not, standard permutations are used. Multiscale property is
defined by the power spectrum (i.e. decomposition of the variance of the
original variables) on a basis of orthonormal eigenvectors (Moran's
Eigenvector Maps, MEM).</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for `4thcorner`</span>
<span class='fu'><a href='msr.html'>msr</a></span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>listwORorthobasis</span>,
  <span class='va'>phyloORorthobasis</span>,
  nrepet <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>npermut</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"pair"</span>, <span class='st'>"triplet"</span>, <span class='st'>"singleton"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object generated by the <code>fourthcorner</code> function.</p></td>
    </tr>
    <tr>
      <th>listwORorthobasis</th>
      <td><p>an object of the class <code>listw</code> (spatial
weights) created by the functions of the <span class="pkg">spdep</span> package or an object
of class <code>orthobasis</code></p></td>
    </tr>
    <tr>
      <th>phyloORorthobasis</th>
      <td><p>an object of the class <code>phylo</code> (phylogeny)
created by the functions of the <span class="pkg">ape</span> package or an object of class
<code>orthobasis</code> generated by functions of <span class="pkg">adephylo</span>
(<code>me.phylo</code>)</p></td>
    </tr>
    <tr>
      <th>nrepet</th>
      <td><p>an <code>integer</code> indicating the number of replicates</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>an character specifying which algorithm should be used to
produce spatial replicates (see code<a href='msr.html'>msr.default</a>).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments of the code<a href='msr.html'>msr.default</a> function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>4thcorner</code> randomized replicates.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Braga, J., Thuiller, W., ter Braak, C.J.F. and Dray, S. (2018)
  Integrating spatial and phylogenetic information in the fourth-corner
  analysis to test trait-environment relationships. Ecology, 99:2667-2674.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='msr.html'>msr.default</a></code>, <code><a href='https://rdrr.io/pkg/adephylo/man/orthobasis.html'>me.phylo</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Stephane Dray <a href='mailto:stephane.dray@univ-lyon1.fr'>stephane.dray@univ-lyon1.fr</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>if</span><span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='http://pbil.univ-lyon1.fr/ADE-4/'>"ade4"</a></span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'>"adephylo"</span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>&amp;</span> <span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/r-spatial/spdep/'>"spdep"</a></span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>&amp;</span> <span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='http://ape-package.ird.fr/'>"ape"</a></span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>mafragh</span>, package <span class='op'>=</span> <span class='st'>"ade4"</span><span class='op'>)</span>
<span class='va'>fr1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ade4/man/fourthcorner.html'>fourthcorner</a></span><span class='op'>(</span><span class='va'>mafragh</span><span class='op'>$</span><span class='va'>env</span>, <span class='va'>mafragh</span><span class='op'>$</span><span class='va'>flo</span>, <span class='va'>mafragh</span><span class='op'>$</span><span class='va'>traits</span><span class='op'>$</span><span class='va'>tabQuantitative</span>, nrepet <span class='op'>=</span> <span class='fl'>49</span><span class='op'>)</span>
<span class='va'>phy</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ape/man/read.tree.html'>read.tree</a></span><span class='op'>(</span>text <span class='op'>=</span> <span class='va'>mafragh</span><span class='op'>$</span><span class='va'>tre</span><span class='op'>)</span>
<span class='va'>lw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>mafragh</span><span class='op'>$</span><span class='va'>nb</span><span class='op'>)</span>
<span class='va'>fr1.msr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='msr.html'>msr</a></span><span class='op'>(</span><span class='va'>fr1</span>, listwORorthobasis <span class='op'>=</span> <span class='va'>lw</span>, phyloORorthobasis <span class='op'>=</span> <span class='va'>phy</span><span class='op'>)</span>

<span class='va'>fr1</span>
<span class='va'>fr1.msr</span>
<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘ape’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:adegraphics’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    zoom</span></div><div class='output co'>#&gt; Fourth-corner Statistics
#&gt; ------------------------
#&gt; Permutation method  msr  ( 49  permutations)
#&gt; 
#&gt; Adjustment method for multiple comparisons:   holm 
#&gt; call:  msr.4thcorner(x = fr1, listwORorthobasis = lw, phyloORorthobasis = phy) 
#&gt; 
#&gt; ---
#&gt; 
#&gt;                         Test Stat          Obs     Std.Obs     Alter Pvalue
#&gt; 1                 Clay / Lfp    r  0.014241856 -0.17505227 two-sided    0.9
#&gt; 2                 Silt / Lfp    r -0.076256133 -0.70621509 two-sided   0.58
#&gt; 3                 Sand / Lfp    r  0.063614861  1.23260415 two-sided   0.26
#&gt; 4                  K2O / Lfp    r  0.031979355  0.54879403 two-sided   0.64
#&gt; 5                 Mg++ / Lfp    r  0.014982765  0.24262471 two-sided   0.88
#&gt; 6             Na+/100g / Lfp    r  0.093499930  1.20881412 two-sided    0.2
#&gt; 7                   K+ / Lfp    r  0.149968927  1.49836870 two-sided    0.1
#&gt; 8         Conductivity / Lfp    r  0.080497038  1.08479291 two-sided   0.32
#&gt; 9            Retention / Lfp    r -0.067943687 -1.22155889 two-sided   0.28
#&gt; 10               Na+/l / Lfp    r  0.063272819  0.97860172 two-sided   0.38
#&gt; 11           Elevation / Lfp    r -0.129537428 -1.58213219 two-sided   0.12
#&gt; 12         Clay / Min height    r  0.061180871  0.92141460 two-sided   0.46
#&gt; 13         Silt / Min height    r -0.052382325 -0.80518641 two-sided   0.46
#&gt; 14         Sand / Min height    r -0.027907397 -0.44677646 two-sided    0.7
#&gt; 15          K2O / Min height    r  0.047550545  0.93849218 two-sided   0.42
#&gt; 16         Mg++ / Min height    r -0.023023055 -0.61086520 two-sided    0.5
#&gt; 17     Na+/100g / Min height    r  0.027191299  0.41785871 two-sided   0.64
#&gt; 18           K+ / Min height    r  0.095029793  1.39144510 two-sided   0.16
#&gt; 19 Conductivity / Min height    r -0.018899856 -0.49055147 two-sided   0.56
#&gt; 20    Retention / Min height    r  0.004165428 -0.12445065 two-sided   0.96
#&gt; 21        Na+/l / Min height    r -0.046119268 -1.06966126 two-sided    0.3
#&gt; 22    Elevation / Min height    r  0.061211127  1.07394978 two-sided   0.34
#&gt; 23         Clay / Max height    r  0.010762151 -0.01785340 two-sided   0.98
#&gt; 24         Silt / Max height    r -0.030835126 -0.27938996 two-sided    0.8
#&gt; 25         Sand / Max height    r  0.027229507  0.61343397 two-sided   0.56
#&gt; 26          K2O / Max height    r  0.063923177  1.06952061 two-sided   0.32
#&gt; 27         Mg++ / Max height    r  0.010886210  0.41253095 two-sided   0.72
#&gt; 28     Na+/100g / Max height    r  0.026525395  0.46885178 two-sided    0.7
#&gt; 29           K+ / Max height    r  0.109401849  1.41283856 two-sided    0.2
#&gt; 30 Conductivity / Max height    r  0.002446542 -0.01717774 two-sided   0.96
#&gt; 31    Retention / Max height    r -0.005456736 -0.21421981 two-sided    0.9
#&gt; 32        Na+/l / Max height    r -0.018577793 -0.50174401 two-sided   0.62
#&gt; 33    Elevation / Max height    r  0.033495574  0.73053271 two-sided   0.44
#&gt;    Pvalue.adj  
#&gt; 1           1  
#&gt; 2           1  
#&gt; 3           1  
#&gt; 4           1  
#&gt; 5           1  
#&gt; 6           1  
#&gt; 7           1  
#&gt; 8           1  
#&gt; 9           1  
#&gt; 10          1  
#&gt; 11          1  
#&gt; 12          1  
#&gt; 13          1  
#&gt; 14          1  
#&gt; 15          1  
#&gt; 16          1  
#&gt; 17          1  
#&gt; 18          1  
#&gt; 19          1  
#&gt; 20          1  
#&gt; 21          1  
#&gt; 22          1  
#&gt; 23          1  
#&gt; 24          1  
#&gt; 25          1  
#&gt; 26          1  
#&gt; 27          1  
#&gt; 28          1  
#&gt; 29          1  
#&gt; 30          1  
#&gt; 31          1  
#&gt; 32          1  
#&gt; 33          1  
#&gt; 
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Stéphane Dray.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


