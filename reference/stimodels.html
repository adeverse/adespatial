<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Space-time interaction in ANOVA without replication — stimodels • adespatial</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Space-time interaction in ANOVA without replication — stimodels"><meta property="og:description" content="Function stimodels performs two-way ANOVA to test space-time
interaction without replicates using one among a set of possible models.
Function quicksti allows performing space-time ANOVA in a simplified
way. In many models, degrees of freedom are saved by coding space and/or
time parsimoniously using distance-based Moran Eigenvector Maps (dbMEM)."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sdray/adespatial/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Space-time interaction in ANOVA without replication</h1>
    <small class="dont-index">Source: <a href="https://github.com/sdray/adespatial/blob/HEAD/R/stimodels.R" class="external-link"><code>R/stimodels.R</code></a></small>
    <div class="hidden name"><code>stimodels.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function <code>stimodels</code> performs two-way ANOVA to test space-time
interaction without replicates using one among a set of possible models.
Function <code>quicksti</code> allows performing space-time ANOVA in a simplified
way. In many models, degrees of freedom are saved by coding space and/or
time parsimoniously using distance-based Moran Eigenvector Maps (dbMEM).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">stimodels</span><span class="op">(</span>
  <span class="va">Y</span>,
  <span class="va">S</span>,
  <span class="va">Ti</span>,
  model <span class="op">=</span> <span class="st">"5"</span>,
  nperm <span class="op">=</span> <span class="fl">999</span>,
  nS <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,
  nT <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,
  Sfixed <span class="op">=</span> <span class="cn">TRUE</span>,
  Tfixed <span class="op">=</span> <span class="cn">TRUE</span>,
  COD.S <span class="op">=</span> <span class="cn">NULL</span>,
  COD.T <span class="op">=</span> <span class="cn">NULL</span>,
  print.res <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="fu">quicksti</span><span class="op">(</span>
  <span class="va">Y</span>,
  <span class="va">S</span>,
  <span class="va">Ti</span>,
  nperm <span class="op">=</span> <span class="fl">999</span>,
  alpha <span class="op">=</span> <span class="fl">0.05</span>,
  COD.S <span class="op">=</span> <span class="cn">NULL</span>,
  COD.T <span class="op">=</span> <span class="cn">NULL</span>,
  print.res <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>Y</dt>
<dd><p>Site-by-species response data table. Assumes row blocks
corresponding to times, i.e. within each block all sites are provided 
(in the same order).</p></dd>
<dt>S</dt>
<dd><p>Number of spatial points (when they are aligned on a transect or a
time series and equispaced) or a matrix of spatial coordinates (when the
sites are on a two-dimensional surface or on a line but very irregularly
spaced).</p></dd>
<dt>Ti</dt>
<dd><p>Number of time campaigns (when equispaced) or a matrix (a
vector) of temporal coordinates (when the time campaigns are very 
irregularly spaced).</p></dd>
<dt>model</dt>
<dd><p>Linear space-time model to be used (can be either "2", "3a",
"3b", "4", "5", "6a", "6b", or "7").</p></dd>
<dt>nperm</dt>
<dd><p>Number of permutations in the significance tests.</p></dd>
<dt>nS</dt>
<dd><p>Number of space dbMEMs to use (by default, -1, all dbMEMs with
positive autocorrelation are used).</p></dd>
<dt>nT</dt>
<dd><p>Number of time dbMEMs to use (by default, -1, all dbMEMs with
positive autocorrelation are used).</p></dd>
<dt>Sfixed</dt>
<dd><p>Logical: is factor Space fixed, or not (if FALSE, it is
considered a random factor).</p></dd>
<dt>Tfixed</dt>
<dd><p>Logical: is factor Time fixed, or not (if FALSE, it is
considered a random factor).</p></dd>
<dt>COD.S</dt>
<dd><p>Spatial coding functions to be used instead of dbMEM. The
number of columns must be lower than <code>S</code> and the number of rows equal
to the number of rows in <code>Y</code>.</p></dd>
<dt>COD.T</dt>
<dd><p>Temporal coding functions to be used instead of dbMEM. The
number of columns must be lower than <code>Ti</code> and the number of rows equal
to the number of rows in <code>Y</code>.</p></dd>
<dt>print.res</dt>
<dd><p>If TRUE displays the results and additional information
onscreen (recommended).</p></dd>
<dt>alpha</dt>
<dd><p>In <code>quicksti</code>, confidence level for the interaction test. 
Depending on the decision for the interaction test, the main factors are 
tested differently.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <dl><dt>testS</dt>
<dd><p>An object with the result of the space effect test, including
the mean squares for the F numerator (<code>MS.num</code>), the mean squares for
the F denominator (<code>MS.den</code>), the proportion of explained variance
(<code>R2</code>), the adjusted proportion of explained variance (<code>R2.adj</code>),
the F statistics (<code>F</code>) and its p-value computed from a permutation test
(<code>Prob</code>).</p></dd>
<dt>testT</dt>
<dd><p>An object with the result of the time effect
test, like <code>testS</code>.</p></dd>
<dt>teststi</dt>
<dd><p>An object with the result of the
space-time interaction test, like <code>testS</code>.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>In <code>stimodels</code> tests for space-time interaction and space or time main
effects are conducted using one of the different models. With Models 2, 6a
and 6b the interaction test is not available.</p>
<p>Model 2 - Space and Time are coded using Helmert contrasts for the main
effects. No interaction is tested. Model 3a - Space is coded using dbMEM
variables whereas Time is coded using Helmert contrasts. Model 3b - Space is
coded using Helmert contrasts whereas Time is coded using dbMEM variables.
Model 4 - Both Space and Time are coded using dbMEM variables for all tests.
Model 5 - Space and Time are coded using Helmert contrasts for the main
factor effects, but they are coded using dbMEM variables for the interaction
term. Model 6a - Nested model. Testing for the existence of spatial
structure (common or separate) using dbMEM variables to code for Space.
Model 6b - Nested model. Testing for the existence of temporal structure
(common or separate) using dbMEM variables to code for Time. Model 7 -
Space and Time are coded using dbMEM variables for the main factor effects,
but they are coded using Helmert contrasts for the interaction term (not
recommended).</p>
<p>When using <code>quicksti</code>, space-time interaction is first tested using
Model 5. Depending on the outcome of this test, the main factors are tested
using different strategies. If the interaction is not significant then the
test of main factors is also done following Model 5. If the interaction is
significant, then a nested model (6a) is used to know whether separate
spatial structures exist and another (6b) to know whether separate temporal
structures exist. In <code>quicksti</code> function space and time are always
considered fixed factors (F ratios are constructed using residual MS in the
denominator).</p>
<p>For the interaction the permutations are unrestricted, whereas for the main
factors the permutations are restricted within time blocks (for the test of
factor Space) or space blocks (for the test of factor Time). By default, the
function computes dbMEM for space and time coding, but other space and/or
time descriptors can be provided by the user, through <code>COD.S</code> and
<code>COD.T</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Borcard, D. and P. Legendre. 2002. All-scale spatial analysis of
ecological data by means of principal coordinates of neighbour matrices.
Ecological Modelling 153: 51-68.</p>
<p>Dray, S., P. Legendre and P. R. Peres-Neto. 2006. Spatial modelling: a
comprehensive framework for principal coordinate analysis of neighbour
matrices (PCNM). Ecological Modelling 196: 483-493.</p>
<p>Legendre, P., M. De Caceres and D. Borcard. 2010. Community surveys through
space and time to assess environmental changes: testing space-time
interaction in the absence of replication. Ecology 91: 262-272.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="trichoptera.html">trichoptera</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Pierre Legendre <a href="mailto:pierre.legendre@umontreal.ca">pierre.legendre@umontreal.ca</a>, Miquel De Caceres and Daniel Borcard</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">trichoptera</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># log-transform species data (excluding site and time colums)</span></span>
<span class="r-in"><span class="va">trich.log</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log1p</a></span><span class="op">(</span><span class="va">trichoptera</span><span class="op">[</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">)</span> </span>
<span class="r-in"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Run space-time interaction test using model "5"</span></span>
<span class="r-in"><span class="fu">stimodels</span><span class="op">(</span><span class="va">trich.log</span>, S<span class="op">=</span><span class="fl">22</span>, Ti<span class="op">=</span><span class="fl">10</span>, nperm<span class="op">=</span><span class="fl">99</span>, model<span class="op">=</span><span class="st">"5"</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =======================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Space-time ANOVA without replicates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Pierre Legendre, Miquel De Caceres, Daniel Borcard</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =======================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of space points (s) = 22 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of time points (tt) = 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of observations (n = s*tt) = 220 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of response variables (p) = 56 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Computing dbMEMs to code for space</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Truncation level for space dbMEMs = 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Computing dbMEMs to code for time</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Truncation level for time dbMEMs = 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of space coding functions = 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Number of time coding functions = 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  MODEL V: HELMERT CONTRAST FOR TESTING MAIN FACTORS. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           SPACE AND TIME dbMEMs FOR TESTING INTERACTION. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Number of space variables = 21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Number of time variables = 9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Number of interaction variables = 40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Number of residual degrees of freedom = 149 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Interaction test:   R2 = 0.1809   F = 2.9235   P( 99 perm) = 0.01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Space test:         R2 = 0.2809   F = 8.6459   P( 99 perm) = 0.01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Time test:          R2 = 0.3076   F = 22.0858   P( 99 perm) = 0.01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Time for this computation = 2.304000  sec </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> =======================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="co"># Run space-time analysis with tests for main effects after testing </span></span>
<span class="r-in"><span class="co"># interaction (which is significant)</span></span>
<span class="r-in"><span class="fu">quicksti</span><span class="op">(</span><span class="va">trich.log</span>, S<span class="op">=</span><span class="fl">22</span>, Ti<span class="op">=</span><span class="fl">10</span>, nperm<span class="op">=</span><span class="fl">99</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Run space-time analysis for time blocks number 6 and 7. </span></span>
<span class="r-in"><span class="co"># Interaction is then not significant and tests of main effects are done </span></span>
<span class="r-in"><span class="co"># following model 5</span></span>
<span class="r-in"><span class="fu">quicksti</span><span class="op">(</span><span class="va">trich.log</span><span class="op">[</span><span class="fl">111</span><span class="op">:</span><span class="fl">154</span>,<span class="op">]</span>, S<span class="op">=</span><span class="fl">22</span>, Ti<span class="op">=</span><span class="fl">2</span>, nperm<span class="op">=</span><span class="fl">99</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stéphane Dray.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

