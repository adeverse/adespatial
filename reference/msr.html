<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Moran spectral randomization — msr • adespatial</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Moran spectral randomization — msr" />
<meta property="og:description" content="This function allows to generate spatially-constrained random variables 
preserving the global autocorrelation (Moran's I) and the spatial structures 
at multiple scales. Multiscale property is defined by the power spectrum 
(i.e. decomposition of the variance of the original variables) on a basis of 
orthonormal eigenvectors (Moran's Eigenvector Maps, MEM). The function 
provides methods for univariate randomization, joint randomization of a group
of variables while keeping within-group correlations fixed and univariate 
randomization with a fixed correlation between original data and randomized 
replicates." />
<meta property="og:image" content="/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3-13</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sdray/adespatial/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Moran spectral randomization</h1>
    <small class="dont-index">Source: <a href='https://github.com/sdray/adespatial/blob/master/R/msr.R'><code>R/msr.R</code></a></small>
    <div class="hidden name"><code>msr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function allows to generate spatially-constrained random variables 
preserving the global autocorrelation (Moran's I) and the spatial structures 
at multiple scales. Multiscale property is defined by the power spectrum 
(i.e. decomposition of the variance of the original variables) on a basis of 
orthonormal eigenvectors (Moran's Eigenvector Maps, MEM). The function 
provides methods for univariate randomization, joint randomization of a group
of variables while keeping within-group correlations fixed and univariate 
randomization with a fixed correlation between original data and randomized 
replicates.</p>
    </div>

    <pre class="usage"><span class='fu'>msr</span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for default</span>
<span class='fu'>msr</span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>listwORorthobasis</span>,
  nrepet <span class='op'>=</span> <span class='fl'>99</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"pair"</span>, <span class='st'>"triplet"</span>, <span class='st'>"singleton"</span><span class='op'>)</span>,
  <span class='va'>cor.fixed</span>,
  nmax <span class='op'>=</span> <span class='fl'>100</span>,
  simplify <span class='op'>=</span> <span class='cn'>TRUE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>For <code>msr.default</code>, a <code>vector</code>, a <code>matrix</code> or a <code>data.frame</code> with the 
original variables. If <code>NCOL(x) &gt; 1</code>, then the joint randomization 
procedure that preserves the correlations among variables is used.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments passed to or from other methods</p></td>
    </tr>
    <tr>
      <th>listwORorthobasis</th>
      <td><p>an object of the class <code>listw</code> (spatial 
weights) created by the functions of the <span class="pkg">spdep</span> package or an object 
of class <code>orthobasis</code></p></td>
    </tr>
    <tr>
      <th>nrepet</th>
      <td><p>an <code>integer</code> indicating the number of replicates</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>an character specifying which algorithm should be used to 
produce spatial replicates (see Details).</p></td>
    </tr>
    <tr>
      <th>cor.fixed</th>
      <td><p>if not missing, the level of correlation between the 
original variable and its randomized replicates</p></td>
    </tr>
    <tr>
      <th>nmax</th>
      <td><p>the number of trials used in the "triplet" procedure.</p></td>
    </tr>
    <tr>
      <th>simplify</th>
      <td><p>A logical value. If <code>TRUE</code>, the outputs for univariate 
procedures are returned in a matrix where each column corresponds to a 
replicate. If <code>FALSE</code> a <code>list</code> is returned.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Either a matrix (if <code>simplify</code> is <code>TRUE</code>) or a list with 
  randomized replicates.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Three procedures are implemented in the function. The "pair" procedure is the
more general as it can be applied in the three cases (univariate, univariate 
with fixed correlation and multivariate). This procedure preserves the power 
spectrum by pair of MEMs but not strictly the global autocorrelation level 
(Moran's I). The "singleton" procedure can be used for univariate and 
multivariate cases. It preserves strictly the global level of autocorrelation
and the power spectrum. The "triplet" procedure can only be applied in the 
univariate case. It preserves the power spectrum by triplet of MEMs and 
strictly the global autocorrelation level.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Wagner, H.H. and Dray S. (2015) Generating spatially-constrained 
  null models for irregularly spaced data using Moran spectral randomization 
  methods. Methods in Ecology and Evolution, 6: 1169-1178.
  doi:10.1111/2041-210X.12407</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='scores.listw.html'>scores.listw</a></code>, <code><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Stephane Dray <a href='mailto:stephane.dray@univ-lyon1.fr'>stephane.dray@univ-lyon1.fr</a> and Helene H 
  Wagner <a href='mailto:helene.wagner@utoronto.ca'>helene.wagner@utoronto.ca</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/r-spatial/spdep/'>spdep</a></span><span class='op'>)</span>
<span class='va'>x1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>rnorm</a></span><span class='op'>(</span><span class='fl'>81</span><span class='op'>*</span><span class='fl'>5</span><span class='op'>)</span>, nrow <span class='op'>=</span> <span class='fl'>81</span><span class='op'>)</span>
<span class='va'>lw1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/spdep/man/cell2nb.html'>cell2nb</a></span><span class='op'>(</span><span class='fl'>9</span>, <span class='fl'>9</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://rdrr.io/pkg/spdep/man/moran.mc.html'>moran.mc</a></span><span class='op'>(</span><span class='va'>x1</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, <span class='va'>lw1</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>$</span><span class='va'>statistic</span>
</div><div class='output co'>#&gt; statistic 
#&gt; 0.0924639 </div><div class='input'>
<span class='co'>## singleton</span>
<span class='va'>x1.1</span> <span class='op'>&lt;-</span> <span class='fu'>msr</span><span class='op'>(</span><span class='va'>x1</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, <span class='va'>lw1</span>, nrepet <span class='op'>=</span> <span class='fl'>9</span>, method <span class='op'>=</span> <span class='st'>"singleton"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>x1.1</span>, <span class='fl'>2</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/pkg/spdep/man/moran.mc.html'>moran.mc</a></span><span class='op'>(</span><span class='va'>x</span>, listw <span class='op'>=</span> <span class='va'>lw1</span>, nsim <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>$</span><span class='va'>statistic</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.0924639 0.0924639 0.0924639 0.0924639 0.0924639 0.0924639 0.0924639
#&gt; [8] 0.0924639 0.0924639</div><div class='input'>
<span class='co'>## triplet</span>
<span class='va'>x1.2</span> <span class='op'>&lt;-</span> <span class='fu'>msr</span><span class='op'>(</span><span class='va'>x1</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, <span class='va'>lw1</span>, nrepet <span class='op'>=</span> <span class='fl'>9</span>, method <span class='op'>=</span> <span class='st'>"triplet"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>x1.2</span>, <span class='fl'>2</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/pkg/spdep/man/moran.mc.html'>moran.mc</a></span><span class='op'>(</span><span class='va'>x</span>, listw <span class='op'>=</span> <span class='va'>lw1</span>, nsim <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>$</span><span class='va'>statistic</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.0924639 0.0924639 0.0924639 0.0924639 0.0924639 0.0924639 0.0924639
#&gt; [8] 0.0924639 0.0924639</div><div class='input'>
<span class='co'>## pair</span>
<span class='va'>x1.3</span> <span class='op'>&lt;-</span> <span class='fu'>msr</span><span class='op'>(</span><span class='va'>x1</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, <span class='va'>lw1</span>, nrepet <span class='op'>=</span> <span class='fl'>9</span>, method <span class='op'>=</span> <span class='st'>"pair"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>x1.3</span>, <span class='fl'>2</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/pkg/spdep/man/moran.mc.html'>moran.mc</a></span><span class='op'>(</span><span class='va'>x</span>, listw <span class='op'>=</span> <span class='va'>lw1</span>, nsim <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>$</span><span class='va'>statistic</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.09619303 0.10164507 0.09596895 0.10036517 0.09744941 0.09388690 0.09151389
#&gt; [8] 0.10085718 0.10062203</div><div class='input'>
<span class='co'>## pair with cor.fixed</span>
<span class='va'>x1.4</span> <span class='op'>&lt;-</span> <span class='fu'>msr</span><span class='op'>(</span><span class='va'>x1</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, <span class='va'>lw1</span>, nrepet <span class='op'>=</span> <span class='fl'>9</span>, cor.fixed <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>x1.4</span>, <span class='fl'>2</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/pkg/spdep/man/moran.mc.html'>moran.mc</a></span><span class='op'>(</span><span class='va'>x</span>, listw <span class='op'>=</span> <span class='va'>lw1</span>, nsim <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>$</span><span class='va'>statistic</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 0.09686600 0.09443010 0.09753183 0.10126359 0.10062545 0.09804654 0.10169157
#&gt; [8] 0.09782210 0.09996856</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x1</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>]</span>, <span class='va'>x1.4</span><span class='op'>)</span>
</div><div class='output co'>#&gt;      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
#&gt; [1,]  0.5  0.5  0.5  0.5  0.5  0.5  0.5  0.5  0.5</div><div class='input'>
<span class='co'>## pair preserving correlations for multivariate data</span>
<span class='va'>x1.5</span> <span class='op'>&lt;-</span> <span class='fu'>msr</span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>lw1</span>, nrepet <span class='op'>=</span> <span class='fl'>9</span>, cor.fixed <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>x1.5</span>, <span class='va'>cor</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [[1]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[2]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[3]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[4]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[5]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[6]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[7]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[8]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[9]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>x1</span>, <span class='fl'>2</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/pkg/spdep/man/moran.mc.html'>moran.mc</a></span><span class='op'>(</span><span class='va'>x</span>, listw <span class='op'>=</span> <span class='va'>lw1</span>, nsim <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>$</span><span class='va'>statistic</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]  0.09246390 -0.01605185 -0.03854826 -0.06531383  0.01553684</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>x1.5</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/pkg/spdep/man/moran.mc.html'>moran.mc</a></span><span class='op'>(</span><span class='va'>x</span>, listw <span class='op'>=</span> <span class='va'>lw1</span>, nsim <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>$</span><span class='va'>statistic</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]  0.09480693 -0.02173623 -0.03049458 -0.07042049  0.01562083</div><div class='input'>
<span class='co'>## singleton preserving correlations for multivariate data</span>
<span class='va'>x1.6</span> <span class='op'>&lt;-</span> <span class='fu'>msr</span><span class='op'>(</span><span class='va'>x1</span>, <span class='va'>lw1</span>, nrepet <span class='op'>=</span> <span class='fl'>9</span>, method <span class='op'>=</span> <span class='st'>"singleton"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>x1</span><span class='op'>)</span>
</div><div class='output co'>#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>x1.6</span>, <span class='va'>cor</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [[1]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[2]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[3]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[4]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[5]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[6]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[7]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[8]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; 
#&gt; [[9]]
#&gt;             [,1]          [,2]        [,3]        [,4]          [,5]
#&gt; [1,]  1.00000000 -0.0205218479 -0.11673321  0.06480616  0.0872952274
#&gt; [2,] -0.02052185  1.0000000000  0.01383488 -0.02103073  0.0006360483
#&gt; [3,] -0.11673321  0.0138348815  1.00000000 -0.05994423  0.0423280959
#&gt; [4,]  0.06480616 -0.0210307318 -0.05994423  1.00000000 -0.1849899685
#&gt; [5,]  0.08729523  0.0006360483  0.04232810 -0.18498997  1.0000000000
#&gt; </div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>x1</span>, <span class='fl'>2</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/pkg/spdep/man/moran.mc.html'>moran.mc</a></span><span class='op'>(</span><span class='va'>x</span>, listw <span class='op'>=</span> <span class='va'>lw1</span>, nsim <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>$</span><span class='va'>statistic</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]  0.09246390 -0.01605185 -0.03854826 -0.06531383  0.01553684</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>x1.6</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>, <span class='fl'>2</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/pkg/spdep/man/moran.mc.html'>moran.mc</a></span><span class='op'>(</span><span class='va'>x</span>, listw <span class='op'>=</span> <span class='va'>lw1</span>, nsim <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span><span class='op'>$</span><span class='va'>statistic</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1]  0.09246390 -0.01605185 -0.03854826 -0.06531383  0.01553684</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Stéphane Dray.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


