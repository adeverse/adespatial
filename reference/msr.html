<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Moran spectral randomization — msr • adespatial</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Moran spectral randomization — msr"><meta property="og:description" content="This function allows to generate spatially-constrained random variables
preserving the global autocorrelation (Moran's I) and the spatial structures
at multiple scales. Multiscale property is defined by the power spectrum
(i.e. decomposition of the variance of the original variables) on a basis of
orthonormal eigenvectors (Moran's Eigenvector Maps, MEM). The function
provides methods for univariate randomization, joint randomization of a group
of variables while keeping within-group correlations fixed and univariate
randomization with a fixed correlation between original data and randomized
replicates."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-24</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/adeverse/adespatial/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Moran spectral randomization</h1>
    <small class="dont-index">Source: <a href="https://github.com/adeverse/adespatial/blob/master/R/msr.R" class="external-link"><code>R/msr.R</code></a></small>
    <div class="hidden name"><code>msr.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function allows to generate spatially-constrained random variables
preserving the global autocorrelation (Moran's I) and the spatial structures
at multiple scales. Multiscale property is defined by the power spectrum
(i.e. decomposition of the variance of the original variables) on a basis of
orthonormal eigenvectors (Moran's Eigenvector Maps, MEM). The function
provides methods for univariate randomization, joint randomization of a group
of variables while keeping within-group correlations fixed and univariate
randomization with a fixed correlation between original data and randomized
replicates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">msr</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">msr</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">listwORorthobasis</span>,</span>
<span>  nrepet <span class="op">=</span> <span class="fl">99</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pair"</span>, <span class="st">"triplet"</span>, <span class="st">"singleton"</span><span class="op">)</span>,</span>
<span>  <span class="va">cor.fixed</span>,</span>
<span>  nmax <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  simplify <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>For <code>msr.default</code>, a <code>vector</code>, a <code>matrix</code> or a <code>data.frame</code> with the
original variables. If <code>NCOL(x) &gt; 1</code>, then the joint randomization
procedure that preserves the correlations among variables is used.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments passed to or from other methods</p></dd>


<dt id="arg-listwororthobasis">listwORorthobasis<a class="anchor" aria-label="anchor" href="#arg-listwororthobasis"></a></dt>
<dd><p>an object of the class <code>listw</code> (spatial
weights) created by the functions of the <span class="pkg">spdep</span> package or an object
of class <code>orthobasis</code></p></dd>


<dt id="arg-nrepet">nrepet<a class="anchor" aria-label="anchor" href="#arg-nrepet"></a></dt>
<dd><p>an <code>integer</code> indicating the number of replicates</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>an character specifying which algorithm should be used to
produce spatial replicates (see Details).</p></dd>


<dt id="arg-cor-fixed">cor.fixed<a class="anchor" aria-label="anchor" href="#arg-cor-fixed"></a></dt>
<dd><p>if not missing, the level of correlation between the
original variable and its randomized replicates</p></dd>


<dt id="arg-nmax">nmax<a class="anchor" aria-label="anchor" href="#arg-nmax"></a></dt>
<dd><p>the number of trials used in the "triplet" procedure.</p></dd>


<dt id="arg-simplify">simplify<a class="anchor" aria-label="anchor" href="#arg-simplify"></a></dt>
<dd><p>A logical value. If <code>TRUE</code>, the outputs for univariate
procedures are returned in a matrix where each column corresponds to a
replicate. If <code>FALSE</code> a <code>list</code> is returned.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Either a matrix (if <code>simplify</code> is <code>TRUE</code>) or a list with
  randomized replicates.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Three procedures are implemented in the function. The "pair" procedure is the
more general as it can be applied in the three cases (univariate, univariate
with fixed correlation and multivariate). This procedure preserves the power
spectrum by pair of MEMs but not strictly the global autocorrelation level
(Moran's I). The "singleton" procedure can be used for univariate and
multivariate cases. It preserves strictly the global level of autocorrelation
and the power spectrum. The "triplet" procedure can only be applied in the
univariate case. It preserves the power spectrum by triplet of MEMs and
strictly the global autocorrelation level.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Wagner, H.H. and Dray S. (2015) Generating spatially-constrained
  null models for irregularly spaced data using Moran spectral randomization
  methods. Methods in Ecology and Evolution, 6: 1169-1178.
  doi:10.1111/2041-210X.12407</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="mem.html">scores.listw</a></code>, <code><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Stephane Dray <a href="mailto:stephane.dray@univ-lyon1.fr">stephane.dray@univ-lyon1.fr</a> and Helene H
  Wagner <a href="mailto:helene.wagner@utoronto.ca">helene.wagner@utoronto.ca</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/" class="external-link">spdep</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">81</span><span class="op">*</span><span class="fl">5</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">81</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lw1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/cell2nb.html" class="external-link">cell2nb</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.mc.html" class="external-link">moran.mc</a></span><span class="op">(</span><span class="va">x1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">lw1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  statistic </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.08901257 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## singleton</span></span></span>
<span class="r-in"><span><span class="va">x1.1</span> <span class="op">&lt;-</span> <span class="fu">msr</span><span class="op">(</span><span class="va">x1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">lw1</span>, nrepet <span class="op">=</span> <span class="fl">9</span>, method <span class="op">=</span> <span class="st">"singleton"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x1.1</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.mc.html" class="external-link">moran.mc</a></span><span class="op">(</span><span class="va">x</span>, listw <span class="op">=</span> <span class="va">lw1</span>, nsim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.08901257 0.08901257 0.08901257 0.08901257 0.08901257 0.08901257 0.08901257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] 0.08901257 0.08901257</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## triplet</span></span></span>
<span class="r-in"><span><span class="va">x1.2</span> <span class="op">&lt;-</span> <span class="fu">msr</span><span class="op">(</span><span class="va">x1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">lw1</span>, nrepet <span class="op">=</span> <span class="fl">9</span>, method <span class="op">=</span> <span class="st">"triplet"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x1.2</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.mc.html" class="external-link">moran.mc</a></span><span class="op">(</span><span class="va">x</span>, listw <span class="op">=</span> <span class="va">lw1</span>, nsim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.08901257 0.08901257 0.08901257 0.08901257 0.08901257 0.08901257 0.08901257</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] 0.08901257 0.08901257</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## pair</span></span></span>
<span class="r-in"><span><span class="va">x1.3</span> <span class="op">&lt;-</span> <span class="fu">msr</span><span class="op">(</span><span class="va">x1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">lw1</span>, nrepet <span class="op">=</span> <span class="fl">9</span>, method <span class="op">=</span> <span class="st">"pair"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x1.3</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.mc.html" class="external-link">moran.mc</a></span><span class="op">(</span><span class="va">x</span>, listw <span class="op">=</span> <span class="va">lw1</span>, nsim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.08853303 0.09114309 0.09651904 0.08944276 0.08881118 0.09331037 0.08668055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] 0.09293674 0.09300961</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## pair with cor.fixed</span></span></span>
<span class="r-in"><span><span class="va">x1.4</span> <span class="op">&lt;-</span> <span class="fu">msr</span><span class="op">(</span><span class="va">x1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">lw1</span>, nrepet <span class="op">=</span> <span class="fl">9</span>, cor.fixed <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x1.4</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.mc.html" class="external-link">moran.mc</a></span><span class="op">(</span><span class="va">x</span>, listw <span class="op">=</span> <span class="va">lw1</span>, nsim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.09022067 0.09567686 0.08808840 0.09551797 0.08840153 0.09349472 0.09440850</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] 0.08910824 0.08807222</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">x1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">x1.4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  0.5  0.5  0.5  0.5  0.5  0.5  0.5  0.5  0.5</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## pair preserving correlations for multivariate data</span></span></span>
<span class="r-in"><span><span class="va">x1.5</span> <span class="op">&lt;-</span> <span class="fu">msr</span><span class="op">(</span><span class="va">x1</span>, <span class="va">lw1</span>, nrepet <span class="op">=</span> <span class="fl">9</span>, cor.fixed <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">x1.5</span>, <span class="va">cor</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[6]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[7]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[8]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[9]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.mc.html" class="external-link">moran.mc</a></span><span class="op">(</span><span class="va">x</span>, listw <span class="op">=</span> <span class="va">lw1</span>, nsim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0.08901257 -0.01819323  0.03040565 -0.02081023  0.01448972</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x1.5</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.mc.html" class="external-link">moran.mc</a></span><span class="op">(</span><span class="va">x</span>, listw <span class="op">=</span> <span class="va">lw1</span>, nsim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0.08883646 -0.02639149  0.02498800 -0.02419777  0.01451139</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## singleton preserving correlations for multivariate data</span></span></span>
<span class="r-in"><span><span class="va">x1.6</span> <span class="op">&lt;-</span> <span class="fu">msr</span><span class="op">(</span><span class="va">x1</span>, <span class="va">lw1</span>, nrepet <span class="op">=</span> <span class="fl">9</span>, method <span class="op">=</span> <span class="st">"singleton"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">x1.6</span>, <span class="va">cor</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[2]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[3]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[4]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[5]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[6]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[7]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[8]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[9]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]        [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]  1.00000000 -0.11247063 -0.02124780  0.06779336 -0.12557621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -0.11247063  1.00000000  0.07607558  0.19724379  0.08485137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -0.02124780  0.07607558  1.00000000 -0.10948813 -0.04034978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  0.06779336  0.19724379 -0.10948813  1.00000000  0.08710798</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.12557621  0.08485137 -0.04034978  0.08710798  1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x1</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.mc.html" class="external-link">moran.mc</a></span><span class="op">(</span><span class="va">x</span>, listw <span class="op">=</span> <span class="va">lw1</span>, nsim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0.08901257 -0.01819323  0.03040565 -0.02081023  0.01448972</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">x1.6</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/moran.mc.html" class="external-link">moran.mc</a></span><span class="op">(</span><span class="va">x</span>, listw <span class="op">=</span> <span class="va">lw1</span>, nsim <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">$</span><span class="va">statistic</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0.08901257 -0.01819323  0.03040565 -0.02081023  0.01448972</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stéphane Dray, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

