<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Multi-frequential periodogram analysis — mfpa • adespatial</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Multi-frequential periodogram analysis — mfpa"><meta property="og:description" content="This function performs multi-frequential periodogram analysis for univariate
temporal or spatial data series collected with equal intervals. Compared with
the traditional periodogram used in spectral analysis, this method can detect
overlapping signals with fractional frequencies. Fitting a joint
polynomial-trigonometric model is achieved by Ordinary Least Squares (OLS)
regression. The function also performs autocorrelation analysis of OLS
residuals up to a number of lags determined by the user."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-26</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/adeverse/adespatial/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multi-frequential periodogram analysis</h1>
    <small class="dont-index">Source: <a href="https://github.com/adeverse/adespatial/blob/master/R/mfpa.R" class="external-link"><code>R/mfpa.R</code></a></small>
    <div class="hidden name"><code>mfpa.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function performs multi-frequential periodogram analysis for univariate
temporal or spatial data series collected with equal intervals. Compared with
the traditional periodogram used in spectral analysis, this method can detect
overlapping signals with fractional frequencies. Fitting a joint
polynomial-trigonometric model is achieved by Ordinary Least Squares (OLS)
regression. The function also performs autocorrelation analysis of OLS
residuals up to a number of lags determined by the user.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mfpa</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  MaxNFreq <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  MinFreq <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  MaxFreq <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  ntrend <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  nlags <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mfpa'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">"Values"</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mfpa'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Vector of <em>n</em> observations (vector of integer or real numbers,
or one-column matrix).</p></dd>


<dt id="arg-maxnfreq">MaxNFreq<a class="anchor" aria-label="anchor" href="#arg-maxnfreq"></a></dt>
<dd><p>Maximum number of frequencies to be estimated in the stepwise
procedure (e.g. 2).</p></dd>


<dt id="arg-minfreq">MinFreq<a class="anchor" aria-label="anchor" href="#arg-minfreq"></a></dt>
<dd><p>Minimum value for frequency estimates (e.g. 3.0).</p></dd>


<dt id="arg-maxfreq">MaxFreq<a class="anchor" aria-label="anchor" href="#arg-maxfreq"></a></dt>
<dd><p>Maximum value for frequency estimates (e.g. 10). Must be larger
than MinFreq and smaller than half of the number of observations in the
series. If unspecified by the user <code>(MaxFreq=NA)</code>, <code>MaxFreq</code> is
set to <em>n</em>/4 by the function.</p></dd>


<dt id="arg-ntrend">ntrend<a class="anchor" aria-label="anchor" href="#arg-ntrend"></a></dt>
<dd><p>Number (0 to 3) of orthogonal polynomial components estimating
the broad-scale trend, to be included in the joint polynomial-trigonometric
model. Use 0 to estimate no trend component, only an intercept.</p></dd>


<dt id="arg-nlags">nlags<a class="anchor" aria-label="anchor" href="#arg-nlags"></a></dt>
<dd><p>Number of lags to be used for autocorrelation analysis of OLS
residuals. Use 0 to bypass this analysis.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Significance threshold for including frequencies.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code>mfpa</code></p></dd>


<dt id="arg-xlab-ylab">xlab, ylab<a class="anchor" aria-label="anchor" href="#arg-xlab-ylab"></a></dt>
<dd><p>Labels for x and y axes</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to or from other methods</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list containing the following elements:</p>
<p></p><ul><li><p><code>frequencies</code>: Vector of estimated frequencies of the
 model periodic components and associated R-squared. The frequencies are
 numbers of cycles in the whole (temporal or spatial) series under study.</p></li>
<li><p><code>coefficients</code>: Data frame containing OLS slope estimates,
 starting with the intercept, then the orthogonal polynomials modelling trend
 in increasing order, followed by the cosine and sine coefficients
 (alternating) in the order of the estimated frequencies. Columns: (1)
 <code>coefficient</code>: the OLS intercept or slope estimates; (2) <code>prob</code>:
 the associated probabilities.</p></li>
<li><p><code>predicted</code>: A vector (length
 <em>n</em>) of predicted response values (fitted values), including the trend
 if any. The data and predicted values can be plotted together using function
 <code>plot.mfpa</code>; type plot(name.of.output.object). The data values are
 represented by red circles and the fitted values by a black line.</p></li>
<li><p><code>auto_coeff</code>: If nlags &gt; 0: data frame containing the following
 columns. (1) <code>lag</code>: lags at which autocorrelation analysis of the OLS
 residuals is performed; (2) <code>auto_r</code>: vector of sample autocorrelation
 coefficients calculated from OLS residuals for each lag; (3) <code>prob</code>:
 vector of probabilities associated with the tests of significance of the
 sample autocorrelation coefficients.</p></li>
<li><p><code>y</code>: the original data
 series (one-column matrix).</p></li>
<li><p><code>X</code>: the matrix of explanatory
 variables; it contains a column of "1" to estimate the intercept, a column
 for each of the trend components (if any), and two columns for each
 frequency component, each frequency being represented by a cosine and a
 sine.</p></li>
<li><p><code>r.squared.global</code>: The global R-squared of the model and
 the adjusted R-squared.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>The fitting of a joint polynomial-trigonometric model is limited to ordinary
least squares (OLS), with autocorrelation analysis of OLS residuals up to a
certain lag. Orthogonal polynomials are used to model broad-scale trends,
whereas cosines and sines model the periodic structures at intermediate
scales. See Dutilleul (2011, section 6.5) and Legendre &amp; Legendre (2012,
section 12.4.4) for details. OLS regression could be replaced by an
<em>estimated generalized least squares</em> (EGLS) procedure, as described in
Dutilleul (2011).</p>
<p>In spectral analysis in general and in mfpa in particular, the cosines and
sines are considered jointly in the search for the dominant frequency
components since they are both required to fully account for a frequency
component in a linear model. So, when either the cosine or the sine is
significant, this is sufficient indication that a significant frequency
component has been found. But see the first paragraph of the 'Recommendations
to users' below.</p>
<p>The periodic phenomenon corresponding to each identified frequency is modelled
by a cosine and a sine. The first pair ('cos 1', 'sin 1') corresponds to the
first frequency, the second pair to the second frequency, and so on. An
intercept is also computed, as well as a polynomial broad-scale trend if
argument ntrend &gt; 0. The coefficients shown for each periodic component ('cos'
and 'sin') are the OLS regression coefficients. The tests of significance
producing the p-values (called 'prob' in the output file) are 2-tailed
parametric t-tests, as in standard OLS regression.</p>
<p>A global R-square statistic for the periodogram is computed as the variance of
the fitted values divided by the variance of the data series. An R-squared
corresponding to each frequency is also returned.</p>
<p>In the Dutilleul periodogram, the time unit is the length of the data series
(in time units: seconds, hours, days, etc.). Hence, the <em>frequency</em>
identified by a Dutilleul periodogram is the number of cycles of the periodic
signal (how many full or partial cycles) along the time series. That number is
an integer when the series contains an integer number of cycles; it may also
be a real number when the number of cycles is fractional. The periodogram can
identify several periodic phenomena with different frequencies. The estimated
frequencies could be divided by an appropriate constant to produce numbers of
cycles per second or day, or per meter or km, depending on the study.</p>
<p>To find the <em>period</em> (number of days, hours, etc.) of the process
generating a periodic signal in the data, divide the length of the series (in
days, hours, etc.) by the frequency identified by Dutilleul's periodogram.</p>
<p>Recommendations to users The mfpa code estimates the periodic frequencies to
be included in the model through a combination of a stepwise procedure and
non-linear optimisation. Following that, the contributions of the 'cos' and
'sin' components of all frequencies in the model are estimated by multiple
linear regression in the presence of the intercept and trends (if any).
Because the mfpa method estimates fractional frequencies, the cos-sin
combinations are not orthogonal among the identified frequencies, and
unnecessary frequencies may be selected as 'significant'.</p>
<p>1. It is important that users of this periodogram have hypotheses in mind
about the frequencies of the processes that may be operating on the system
under study and the number of periodic components they are expecting to find.
If one asks for more components than the number of periodic phenomena at work
on the system, the 'real' frequency usually has a strong or fairly strong
R-squared and it is followed by other components with very small R-squared.
Selection of frequencies of interest should thus be based more upon
examination of the R-squares of the components rather than on the p-values.
For short series in particular, the adjusted R-squared is an unbiased estimate
of the variance of the data explained by the model. Even series of random
numbers can produce 'significant' frequencies for periodic components; the
associated (adjusted) R-squares will, however, be very small.</p>
<p>2. Function mfpa cannot detect frequencies &lt; 1 (smaller than one cycle in the
series) or larger than (<em>n</em>-1) where <em>n</em> is the number of
observations in the series, the latter case corresponding to periods smaller
than the interval between successive observations. When a periodic component
with such a period is present in the data, Dutilleul's periodogram can detect
harmonics of that frequency. Recommendation: when a frequency is detected that
does not seem to correspond to a hypothesized process, one could check, using
simulated data, if it could be produced by a process operating at a temporal
scale (period) smaller than the interval between successive observations.  An
example is shown in Example 2.</p>
<p>3. When analysing a time series with unknown periodic structure, it is
recommended to try first with more than one frequency, say 2 or 3, and also
with a trend. Eliminate the non-significant components, step by step, in
successive runs, starting with the trend(s), then eliminate the weakly
significant periodic components, until there are only highly significant
components left in the model.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Dutilleul, P. 1990. Apport en analyse spectrale d'un périodogramme modifié et
modélisation des séries chronologiques avec répétitions en vue de leur
comparaison en fréquence. Doctoral Dissertation, Université Catholique de
Louvain, Louvain-la-Neuve, Belgium.</p>
<p>Dutilleul, P. 1998. Incorporating scale in ecological experiments: data
analysis. Pp. 387-425 in: D. L. Peterson &amp; V. T. Parker [eds.] Ecological
scale - Theory and applications. Columbia University Press, New York.</p>
<p>Dutilleul, P. 2001. Multi-frequential periodogram analysis and the detection
of periodic components in time series. Commun. Stat. - Theory Methods 30,
1063-1098.</p>
<p>Dutilleul, P. R. L. 2011. Spatio-temporal heterogeneity - Concepts and
analyses. Cambridge University Press, Cambridge.</p>
<p>Dutilleul, P. and C. Till. 1992. Evidence of periodicities related to climate
and planetary behaviors in ring-width chronologies of Atlas cedar (Cedrus
atlantica) in Morocco. Can. J. For. Res. 22: 1469-1482.</p>
<p>Legendre, P. and P. Dutilleul. 1992. Introduction to the analysis of periodic
phenomena. 11-25 in: M. A. Ali [ed.] Rhythms in fishes. NATO ASI Series, Vol.
A-236. Plenum, New York.</p>
<p>Legendre, P. and L. Legendre. 2012. Numerical Ecology. 3rd English edition.
Elsevier, Amsterdam.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Guillaume Larocque &lt;glaroc@gmail.com&gt; and Pierre Legendre.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example 1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate data with frequencies 2.3 and 6.1 and a random component, n = 100. </span></span></span>
<span class="r-in"><span><span class="co"># No trend, no autocorrelated residuals.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="fl">0.4</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2.3</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span><span class="fl">0.4</span><span class="op">*</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">6.1</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">mfpa</span><span class="op">(</span><span class="va">y</span>, MaxNFreq <span class="op">=</span> <span class="fl">2</span>, MinFreq <span class="op">=</span> <span class="fl">2</span>, ntrend <span class="op">=</span> <span class="fl">0</span>, nlags <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute the periods associated with the two periodic components. Each</span></span></span>
<span class="r-in"><span><span class="co"># frequency in element $frequencies is a number of cycles in the whole series.</span></span></span>
<span class="r-in"><span><span class="co"># The periods are expressed in numbers of time intervals of the data series. In</span></span></span>
<span class="r-in"><span><span class="co"># this example, if the data are measured every min, the periods are in min.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">periods</span> <span class="op">&lt;-</span> <span class="fl">100</span><span class="op">/</span><span class="va">res</span><span class="op">$</span><span class="va">frequencies</span><span class="op">$</span><span class="va">frequency</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Draw the data series and the fitted (or predicted) values</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mfpa-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example 2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate hourly periodic data with tide signal (tide period T = 12.42 h)</span></span></span>
<span class="r-in"><span><span class="co"># during 1 year, hence 24*365 = 8760 hourly data. See</span></span></span>
<span class="r-in"><span><span class="co"># https://en.wikipedia.org/wiki/Tide.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In this simulation, constant (c = 0) puts the maximum value of the cosine at</span></span></span>
<span class="r-in"><span><span class="co"># midnight on the first day of the series.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">periodic.component</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">T</span>, <span class="va">c</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="cn">T</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="va">c</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tide.h</span> <span class="op">&lt;-</span> <span class="fu">periodic.component</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">8760</span>, <span class="fl">12.42</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The number of tides in the series is: 8760/12.42 = 705.314 tidal cycles</span></span></span>
<span class="r-in"><span><span class="co"># during one year.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sample the hourly data series once a day at 12:00 noon every day. The</span></span></span>
<span class="r-in"><span><span class="co"># periodic signal to be detected has a period smaller then the interval between</span></span></span>
<span class="r-in"><span><span class="co"># consecutive observations and its frequency is larger than (n-1). The sequence</span></span></span>
<span class="r-in"><span><span class="co"># of sampling hours for the tide.h data is:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">h.noon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">8760</span>, <span class="fl">24</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">tide.data</span> <span class="op">&lt;-</span> <span class="va">tide.h</span><span class="op">[</span><span class="va">h.noon</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">tide.data</span><span class="op">)</span>   </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 365</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The series contains 365 sampling units</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute Dutilleul's multi-frequential periodogram</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res.noon</span> <span class="op">&lt;-</span> <span class="fu">mfpa</span><span class="op">(</span><span class="va">tide.data</span>, MaxNFreq <span class="op">=</span> <span class="fl">1</span>, MinFreq <span class="op">=</span> <span class="fl">2</span>, ntrend <span class="op">=</span> <span class="fl">1</span>, nlags <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examine the frequency detected by the periodogram, element</span></span></span>
<span class="r-in"><span><span class="co"># res.noon$frequencies. This is a harmonic of the tide signal in the original</span></span></span>
<span class="r-in"><span><span class="co"># data series tide.h.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute the period of the signal in the data series sampled hourly:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">period</span> <span class="op">&lt;-</span> <span class="fl">365</span><span class="op">/</span><span class="va">res.noon</span><span class="op">$</span><span class="va">frequencies</span><span class="op">$</span><span class="va">frequency</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Draw the data series and the adjusted values</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.noon</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mfpa-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Repeat this analysis after addition of random noise to the tide data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tide.noise</span> <span class="op">&lt;-</span> <span class="va">tide.data</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">365</span>, <span class="fl">0</span>, <span class="fl">0.25</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res.noise</span> <span class="op">&lt;-</span> <span class="fu">mfpa</span><span class="op">(</span><span class="va">tide.noise</span>, MaxNFreq <span class="op">=</span> <span class="fl">1</span>, MinFreq <span class="op">=</span> <span class="fl">2</span>, ntrend <span class="op">=</span> <span class="fl">1</span>, nlags <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.noise</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="mfpa-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stéphane Dray, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

