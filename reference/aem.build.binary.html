<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Construct a site-by-edge binary matrix — aem.build.binary • adespatial</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Construct a site-by-edge binary matrix — aem.build.binary"><meta property="og:description" content="This function construct a site-by-edge binary matrix. It uses a set of sites
coordinates and a connexion diagram (object of class nb from the
spdep package). The 1s in the matrix represents the presence of a link
influencing a site, directly or indirectly, otherwise the values are 0s.
Graphically, the function is implemented such that the directional process is
considered to be going from the bottom to the top of the screen in the
graphical output of R. As such, the origin is underneath the set of points
representing the sites. Prepare the table of site coordinates accordingly."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-24</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/adeverse/adespatial/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Construct a site-by-edge binary matrix</h1>
    <small class="dont-index">Source: <a href="https://github.com/adeverse/adespatial/blob/master/R/aem.build.binary.R" class="external-link"><code>R/aem.build.binary.R</code></a></small>
    <div class="hidden name"><code>aem.build.binary.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function construct a site-by-edge binary matrix. It uses a set of sites
coordinates and a connexion diagram (object of class <code>nb</code> from the
<code>spdep</code> package). The 1s in the matrix represents the presence of a link
influencing a site, directly or indirectly, otherwise the values are 0s.
Graphically, the function is implemented such that the directional process is
considered to be going from the bottom to the top of the screen in the
graphical output of R. As such, the origin is underneath the set of points
representing the sites. Prepare the table of site coordinates accordingly.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">aem.build.binary</span><span class="op">(</span></span>
<span>  nb.object <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">coords</span>,</span>
<span>  link <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  unit.angle <span class="op">=</span> <span class="st">"degrees"</span>,</span>
<span>  rot.angle <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  rm.same.y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot.connexions <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-nb-object">nb.object<a class="anchor" aria-label="anchor" href="#arg-nb-object"></a></dt>
<dd><p>Object of class <code>nb</code> from library spdep.</p></dd>


<dt id="arg-coords">coords<a class="anchor" aria-label="anchor" href="#arg-coords"></a></dt>
<dd><p>A three columns matrix or data frame. Colums 1: identifiers of
the points (needs to be numeric). Columns 2 and 3: the X and Y coordinates
of the points.</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>A two columns matrix. Each row define an edge. Column 1: The site
from which the edge starts. Column 2: the site to which the edge ends. All
values in <code>link</code> need to be integers.</p></dd>


<dt id="arg-unit-angle">unit.angle<a class="anchor" aria-label="anchor" href="#arg-unit-angle"></a></dt>
<dd><p>Character. The measurement units in which the angle is
defined: either "degrees" (default) or "radians".</p></dd>


<dt id="arg-rot-angle">rot.angle<a class="anchor" aria-label="anchor" href="#arg-rot-angle"></a></dt>
<dd><p>Numeric. Angle of the vector describing the process
influencing the sites. This argument generate a rotation of the site
coordinates. The set of coordinates is rotated counterclockwise. Negative
values will produce a clockwise rotation.</p></dd>


<dt id="arg-rm-same-y">rm.same.y<a class="anchor" aria-label="anchor" href="#arg-rm-same-y"></a></dt>
<dd><p>Logical (<code>TRUE</code>, <code>FALSE</code>). Determines if the links
perpendicular to the gradient should be removed. Default value:
<code>TRUE</code>. If these links have already been removed this argument put to
<code>TRUE</code> will make the function crash. See detail for more information.</p></dd>


<dt id="arg-plot-connexions">plot.connexions<a class="anchor" aria-label="anchor" href="#arg-plot-connexions"></a></dt>
<dd><p>Logical (<code>TRUE</code>, <code>FALSE</code>). Determines if the
sites and the associated connexion diagram should be plotted after rotation
of the coordinates by <code>gradient.angle</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>


<dl><dt><code>se.mat</code></dt>
<dd><p>A binary (n x k) matrix of site (n rows) by link edges
(k columns).</p></dd>
 <dt><code>edges</code></dt>
<dd><p>A matrix describing the link edges. It has
2 columns (from, to) and as many rows as there are edges. The edges linked to
the fictitious site of origin are found at the beginning of the list.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The lowest site in the gradient is the one that will connect to the
fictitious site 0 to consider direction. Note that if there are multiple
lowest sites, they will all be connected to the fictitious site 0 to consider
direction.</p>


<p>The site-by-edge matrix created by this function and the list of edges
include the links associated to a fictitious site upstream of all other, see
Blanchet et al. (2008), for details. The decision regarding wether the
origin and the edges associated with it should be kept or removed is left to
the user. Removal of this site and of its associated edges can be done
manually after the construction of the site-by-edge matrix and of the list
edges. It can also be done when running the function <code><a href="aem.html">aem</a></code>.</p>
<p>If the connexion diagram was modified so that the links connecting sites that
are exactly perpendicular to the gradient have been removed or if there is no
sites exactly at the same level in the gradient, defining <code>rm.same.y</code> to
<code>TRUE</code> will generate an error.</p>
<p>If all the sites have the same y coordinates after rotation, e.g. a
horizontal transect perpendicular to the defined spatial asymmetry, this
analysis should not be used.</p>
<p>The argument <code>plot.connexions</code> will plot the sites (<code>coords</code>) in
black, after rotation, if any, and the connexion diagram (<code>nb.object</code>),
in red. The site labels are also plotted on the graph. To show the direction
of the spatial asymmetry considered by the function, a fictive site (in blue)
was added upstream. This fictive site is linked (blue edges) to the site(s)
that are the most upstream ones. Since this graph is generic, it might
sometimes look odd, however, the information given will remain the accurate.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Blanchet F.G., P. Legendre and Borcard D. (2008) Modelling directional
spatial processes in ecological data. <em>Ecological Modelling</em>, 215,
325-336.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="aem.html">aem</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>F. Guillaume Blanchet</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Create an object of class nb (spdep)</span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://github.com/r-spatial/spdep/" class="external-link">"spdep"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">nb</span><span class="op">&lt;-</span><span class="fu"><a href="https://r-spatial.github.io/spdep/reference/cell2nb.html" class="external-link">cell2nb</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span>,<span class="st">"queen"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Create fictitious geographical coordinates </span></span></span>
<span class="r-in"><span><span class="va">xy</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span>,<span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Build a binary site-by-link matrix; remove the site which have identical Y coordinate</span></span></span>
<span class="r-in"><span><span class="co">### (by default argument: rm.same.y = TRUE)</span></span></span>
<span class="r-in"><span><span class="va">bin.mat</span> <span class="op">&lt;-</span> <span class="fu">aem.build.binary</span><span class="op">(</span><span class="va">nb</span>,<span class="va">xy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">bin.mat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Build a binary site-by-link matrix using the argument link: remove the site which</span></span></span>
<span class="r-in"><span><span class="co">### have identical Y coordinate (by default argument: rm.same.y = TRUE)</span></span></span>
<span class="r-in"><span><span class="va">edges</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bin.mat</span> <span class="op">&lt;-</span> <span class="fu">aem.build.binary</span><span class="op">(</span>coords<span class="op">=</span><span class="va">xy</span>,link<span class="op">=</span><span class="va">edges</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">bin.mat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Build a binary site-by-link matrix, making the process affect the points at </span></span></span>
<span class="r-in"><span><span class="co">### an angle of 45 degrees</span></span></span>
<span class="r-in"><span><span class="va">bin.mat.45</span> <span class="op">&lt;-</span> <span class="fu">aem.build.binary</span><span class="op">(</span><span class="va">nb</span>,<span class="va">xy</span>, rot.angle<span class="op">=</span><span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">bin.mat.45</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Build a binary site-by-link matrix, making the process affect the points at</span></span></span>
<span class="r-in"><span><span class="co">### an angle of pi/3 radians</span></span></span>
<span class="r-in"><span><span class="va">bin.mat.pi3</span> <span class="op">&lt;-</span> <span class="fu">aem.build.binary</span><span class="op">(</span><span class="va">nb</span>,<span class="va">xy</span>,unit.angle<span class="op">=</span><span class="st">"radians"</span>, rot.angle<span class="op">=</span><span class="va">pi</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">bin.mat.pi3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="aem.build.binary-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ se.mat: int [1:25, 1:57] 1 0 0 0 0 1 1 0 0 0 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ edges : num [1:57, 1:2] 0 0 0 0 0 1 1 2 2 2 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:57] "" "" "" "" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:2] "from" "to"</span>
<span class="r-plt img"><img src="aem.build.binary-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ se.mat: int [1:25, 1:25] 1 0 0 0 0 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ edges : num [1:25, 1:2] 0 0 0 0 0 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:25] "" "" "" "" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:2] "from" "to"</span>
<span class="r-plt img"><img src="aem.build.binary-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ se.mat: int [1:25, 1:57] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ edges : num [1:57, 1:2] 0 1 1 1 2 2 2 3 3 3 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:57] "" "1" "2" "3" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:2] "from" "to"</span>
<span class="r-plt img"><img src="aem.build.binary-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ se.mat: int [1:25, 1:73] 1 1 1 1 1 1 1 1 1 1 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ edges : num [1:73, 1:2] 0 1 1 1 2 6 2 2 3 7 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..- attr(*, "dimnames")=List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:73] "" "1" "2" "3" ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ : chr [1:2] "from" "to"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stéphane Dray, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

