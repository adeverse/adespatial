<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Moran spectral randomization for Mantel test — msr.mantelrtest • adespatial</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Moran spectral randomization for Mantel test — msr.mantelrtest" />
<meta property="og:description" content="This function allows to test the Mantel statistic using constrained null
models in the presence of spatial autocorrelation. Random replicates of the
second distance matrix are produced. They are spatially-constrained to
preserve the global autocorrelation (Moran's I) and the spatial structures at
multiple scales. Multiscale property is defined by the power spectrum (i.e.
decomposition of the variance of the original variables) on a basis of
orthonormal eigenvectors (Moran's Eigenvector Maps, MEM)." />
<meta property="og:image" content="/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3-14</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/sdray/adespatial/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Moran spectral randomization for Mantel test</h1>
    <small class="dont-index">Source: <a href='https://github.com/sdray/adespatial/blob/master/R/msr.mantelrtest.R'><code>R/msr.mantelrtest.R</code></a></small>
    <div class="hidden name"><code>msr.mantelrtest.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function allows to test the Mantel statistic using constrained null
models in the presence of spatial autocorrelation. Random replicates of the
second distance matrix are produced. They are spatially-constrained to
preserve the global autocorrelation (Moran's I) and the spatial structures at
multiple scales. Multiscale property is defined by the power spectrum (i.e.
decomposition of the variance of the original variables) on a basis of
orthonormal eigenvectors (Moran's Eigenvector Maps, MEM).</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for mantelrtest</span>
<span class='fu'><a href='msr.html'>msr</a></span><span class='op'>(</span>
  <span class='va'>x</span>,
  <span class='va'>listwORorthobasis</span>,
  nrepet <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>rep</span>,
  method <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"pair"</span>, <span class='st'>"triplet"</span>, <span class='st'>"singleton"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object generated by the <code>mantel.randtest</code> function.</p></td>
    </tr>
    <tr>
      <th>listwORorthobasis</th>
      <td><p>an object of the class <code>listw</code> (spatial
weights) created by the functions of the <span class="pkg">spdep</span> package or an object
of class <code>orthobasis</code></p></td>
    </tr>
    <tr>
      <th>nrepet</th>
      <td><p>an <code>integer</code> indicating the number of replicates</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>an character specifying which algorithm should be used to
produce spatial replicates (see <code><a href='msr.html'>msr.default</a></code>).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments of the <code><a href='msr.html'>msr.default</a></code> function.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>randtest</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Crabot, J., Clappe, S., Dray, S. and Datry, T. (2019) Testing the
  Mantel statistic with a spatially-constrained permutation procedure.
  Methods in Ecology and Evolution. in press.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='msr.html'>msr.default</a></code>, <code><a href='https://rdrr.io/pkg/ade4/man/mantel.randtest.html'>mantel.randtest</a></code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Sylvie Clappe, Stephane Dray <a href='mailto:stephane.dray@univ-lyon1.fr'>stephane.dray@univ-lyon1.fr</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>if</span><span class='op'>(</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='http://pbil.univ-lyon1.fr/ADE-4/'>"ade4"</a></span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>&amp;</span> <span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='st'><a href='https://github.com/r-spatial/spdep/'>"spdep"</a></span>, quietly <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>mafragh</span>, package <span class='op'>=</span> <span class='st'>"ade4"</span><span class='op'>)</span>

<span class='va'>d1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span><span class='op'>(</span><span class='va'>mafragh</span><span class='op'>$</span><span class='va'>env</span><span class='op'>[</span>,<span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>d2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/dist.html'>dist</a></span><span class='op'>(</span><span class='va'>mafragh</span><span class='op'>$</span><span class='va'>env</span><span class='op'>[</span>,<span class='fl'>7</span><span class='op'>]</span><span class='op'>)</span>
<span class='va'>t1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ade4/man/mantel.randtest.html'>mantel.randtest</a></span><span class='op'>(</span><span class='va'>d1</span>,<span class='va'>d2</span><span class='op'>)</span>
<span class='va'>t1</span>

<span class='va'>lw</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/spdep/man/nb2listw.html'>nb2listw</a></span><span class='op'>(</span><span class='va'>mafragh</span><span class='op'>$</span><span class='va'>nb</span><span class='op'>)</span>
<span class='va'>t2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='msr.html'>msr</a></span><span class='op'>(</span><span class='va'>t1</span>, listwORorthobasis <span class='op'>=</span> <span class='va'>lw</span><span class='op'>)</span>
<span class='va'>t2</span>

<span class='op'>}</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: Zero distance(s)</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Zero distance(s)</span></div><div class='output co'>#&gt; Monte-Carlo test
#&gt; Call: msr.mantelrtest(x = t1, listwORorthobasis = lw)
#&gt; 
#&gt; Observation: 0.1197583 
#&gt; 
#&gt; Based on 999 replicates
#&gt; Simulated p-value: 0.202 
#&gt; Alternative hypothesis: greater 
#&gt; 
#&gt;     Std.Obs Expectation    Variance 
#&gt; 0.859273135 0.043359171 0.007905233 </div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Stéphane Dray.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


