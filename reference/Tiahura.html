<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Tiahura Transect Fish Data Set — Tiahura • adespatial</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Tiahura Transect Fish Data Set — Tiahura"><meta property="og:description" content="Fish community composition, ecological traits, and environmental
characteristics observed along a 1-km coral reef transect."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-26</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/adeverse/adespatial/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Tiahura Transect Fish Data Set</h1>
    <small class="dont-index">Source: <a href="https://github.com/adeverse/adespatial/blob/master/R/Tiahura.R" class="external-link"><code>R/Tiahura.R</code></a></small>
    <div class="hidden name"><code>Tiahura.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fish community composition, ecological traits, and environmental
characteristics observed along a 1-km coral reef transect.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Tiahura</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="format">
    <h2>Format</h2>
    <p>A list with four elements:</p><dl><dt>fish</dt>
<dd><p>A data frame with 22 rows (sites) and 280 columns (fish
species) describing the presence (value: 1) or absence (value: 0) of the fish
species at the sites.</p></dd>

<dt>species</dt>
<dd><p>A character vector with 280 elements containing the binomial
(latin) names of the 280 fish species.</p></dd>

<dt>trait</dt>
<dd><p>A data frame with 280 rows (species) and five columns (traits)
containing the species ecological traits (see details).</p></dd>

<dt>habitat</dt>
<dd><p>A data frame with 22 rows (sites) and 10 columns
(characteristics) containing the environmental characteristics of the sites
 (see details).</p></dd>

<dt>reef</dt>
<dd><p>A data frame with 6 rows (sections) and 3 columns
describing the different sections of the transect (see details).</p></dd>


</dl></div>
    <div id="source">
    <h2>Source</h2>
    <p>Pierre Legendre &lt;pierre.legendre@umontreal.ca&gt;, René Galzin
&lt;pol@univ-perp.fr&gt;, Mireille Harmelin-Vivien &lt;Harmelin@com.univ-mrs.fr&gt;,
and Guillaume Guenard &lt;guillaume.guenard@gmail.com&gt;</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The Tiahura fish transect data was described and analyzed by
Galzin &amp; Legendre (1987). It consists of presence/absence data for 280 fish
species observed at 22 sites along a 1.02 km long coast-to-sea cross-reef
transect located near the northwestern corner of the high volcanic island of
Moorea (French Polynesia; WGS84: -17.4934, -149.8680). The survey sites were
50 m long. Species presence/absence data were recorded by a diver trained in
underwater fish identification. The transect began on a coral sand beach,
followed by a zone of detritic sediments, then a dying reef flat, followed by
a zone of coral patches. That relatively flat area ended at a 100-m wide -
9-m deep channel, followed by a 490-m wide barrier reef, which ended in a
slightly elevated reef ridge, followed by the outer slope into the Pacific
Ocean. The survey was terminated at depth of approximately 25 m; this is the
maximum depth allowing scuba diving for any length of time without having to
perform decompression stops. For further details about the transect and
survey method, see Galzin &amp; Legendre (1987).</p>
<p>Ecological traits contained in data frame <code>trait</code> are</p><dl><dt>Feeding</dt>
<dd><p>A seven-level categorical variables describing the feeding
habits of the fish species</p></dd>

<dt>Ecology</dt>
<dd><p>A seven-level categorical variable describing the general
behavior of the fish species in their habitats</p></dd>

<dt>Adult</dt>
<dd><p>A six-level ordered variables describing the adult sizes of the
fish species</p></dd>

<dt>Egg</dt>
<dd><p>A three-level categorical variable describing the types of eggs
laid by the fish species</p></dd>

<dt>Activity</dt>
<dd><p>A three-level categorical variable describing the
activity rhythm of the fish species</p></dd>


</dl><p>Environmental characteristics contained in data frame <code>habitat</code> are the
distance from the shore (in m), the water depth at the site (in cm), and
substrate composition. Substrate composition (environmental characteristics
3 - 10) is described by percentage coverage indices of the reef bottom by
different materials, based on 50 observation points. These observations
points were positioned at 1-m intervals along a 50-m rope. The variables
indicate what proportion of the 50 readings pertained to each category of
substrate. Several of these categories represent biological materials lying
on top of, intermingled with, or attached to the mineral substrate. When the
22 stations are considered globally, these eight substrate categories
respectively represent 2.5<!-- %, 31.1%, 11.4%, 14.3%, 13.9%, 18.7%, 7.5%, and -->
0.7<!-- % of the observed points. --></p>
<p>Data frame <code>reef</code>, which contains the boundaries of the different
sections of the transect, comes in handy for displaying data graphically and
interpret results.</p>
<p>This data set was made available to the students in the European Advanced
Course "Numerical Analysis in Marine Ecology" given at Observatoire
océanologique, Université Paris VI, Villefranche-sur-Mer, on 3 - 20 July
1996.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Galzin, R. &amp; P. Legendre. 1987. The fish communities of a coral
reef transect. Pacific Science 41: 158-165.</p>
<p>Legendre, P., R. Galzin &amp; M. Harmelin-Vivien. 1997. Relating behavior to
habitat: Solutions to the fourth-corner problem. Ecology 78: 547-562</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Tiahura</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Compute dissimilary matrix from Jaccard's similarity coefficient:</span></span></span>
<span class="r-in"><span><span class="va">tiah.jac</span> <span class="op">&lt;-</span> <span class="fu"><a href="dist.ldc.html">dist.ldc</a></span><span class="op">(</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">fish</span>,method <span class="op">=</span> <span class="st">"jaccard"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Info -- D is Euclidean because the function outputs D[jk] = sqrt(1-S[jk])</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Constrained clustering of the fish species:</span></span></span>
<span class="r-in"><span><span class="va">tiah.chclust</span> <span class="op">&lt;-</span> <span class="fu"><a href="constr.hclust.html">constr.hclust</a></span><span class="op">(</span><span class="va">tiah.jac</span>, coords<span class="op">=</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">habitat</span><span class="op">[</span>,<span class="st">"distance"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                              chron<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plotting the results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## First graph: constrained clusters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">6.5</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dst</span> <span class="op">&lt;-</span> <span class="va">Tiahura</span><span class="op">$</span><span class="va">habitat</span><span class="op">[</span>,<span class="st">"distance"</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">dst</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">5.5</span><span class="op">)</span>, yaxt<span class="op">=</span><span class="st">"n"</span>,</span></span>
<span class="r-in"><span>     ylab<span class="op">=</span><span class="st">"Partitions\n\n"</span>, xlab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">parts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">12</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"turquoise"</span>, <span class="st">"orange"</span>, <span class="st">"chartreuse"</span>, <span class="st">"aquamarine"</span>, <span class="st">"blue"</span>,</span></span>
<span class="r-in"><span>          <span class="st">"violet"</span>, <span class="st">"pink"</span>, <span class="st">"cyan"</span>, <span class="st">"green"</span>, <span class="st">"red"</span>, <span class="st">"cornsilk"</span>, <span class="st">"purple"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1L</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">parts</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">tiah.chclust</span><span class="op">$</span><span class="va">coords</span><span class="op">[</span>,<span class="st">"y"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">i</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tiah.chclust</span>, <span class="va">parts</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, link<span class="op">=</span><span class="cn">TRUE</span>, lwd<span class="op">=</span><span class="fl">3</span>, hybrids<span class="op">=</span><span class="st">"none"</span>,</span></span>
<span class="r-in"><span>       lwd.pt<span class="op">=</span><span class="fl">0.5</span>, cex<span class="op">=</span><span class="fl">3</span>, pch<span class="op">=</span><span class="fl">21</span>, plot<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>       col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cols</span><span class="op">)</span>, length.out<span class="op">=</span><span class="va">parts</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span>, at<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">parts</span><span class="op">)</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">parts</span>,<span class="st">"groups"</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Second graph: transect profile</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">6.5</span>,<span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">dst</span>, y<span class="op">=</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">habitat</span><span class="op">[</span>,<span class="st">"depth"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>     ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">habitat</span><span class="op">[</span>,<span class="st">"depth"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,<span class="op">-</span><span class="fl">300</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     las<span class="op">=</span><span class="fl">1</span>, ylab<span class="op">=</span><span class="st">"Depth\n(cm)\n"</span>, xlab<span class="op">=</span><span class="st">""</span>, type<span class="op">=</span><span class="st">"l"</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">reef</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">reef</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">reef</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span><span class="op">]</span>, lty<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span><span class="op">(</span><span class="op">(</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">reef</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span><span class="op">]</span> <span class="op">-</span> <span class="va">Tiahura</span><span class="op">$</span><span class="va">reef</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">&lt;</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">(</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">reef</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">Tiahura</span><span class="op">$</span><span class="va">reef</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, y<span class="op">=</span><span class="fl">2350</span>,</span></span>
<span class="r-in"><span>         labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">reef</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span>,srt<span class="op">=</span><span class="fl">90</span>,adj<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x<span class="op">=</span><span class="op">(</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">reef</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">Tiahura</span><span class="op">$</span><span class="va">reef</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>, y<span class="op">=</span><span class="op">-</span><span class="fl">150</span>,</span></span>
<span class="r-in"><span>         labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">toupper</a></span><span class="op">(</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">reef</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Third graph: bottom composition</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6.5</span>,<span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>,xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">dst</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, las<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>     ylab<span class="op">=</span><span class="st">"Bottom composition\n(proportions)\n"</span>, xlab<span class="op">=</span><span class="st">"Distance (m)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">Tiahura</span><span class="op">$</span><span class="va">habitat</span><span class="op">[</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="va">bot</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">bot</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span> <span class="op">+</span> <span class="va">bot</span><span class="op">[</span>,<span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"grey75"</span>, <span class="st">"brown"</span>, <span class="st">"grey25"</span>, <span class="st">"green"</span>, <span class="st">"purple"</span>,</span></span>
<span class="r-in"><span>          <span class="st">"lightgreen"</span>, <span class="st">"yellow"</span>, <span class="st">"white"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dst</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">dst</span><span class="op">)</span><span class="op">)</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">bot</span><span class="op">[</span>,<span class="va">i</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">bot</span><span class="op">[</span>,<span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">50</span>,</span></span>
<span class="r-in"><span>          col<span class="op">=</span><span class="va">cols</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">44</span>, <span class="fl">365</span>, <span class="fl">707</span>, <span class="fl">538</span>, <span class="fl">957</span>, <span class="fl">111</span>, <span class="fl">965</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.47</span>, <span class="fl">0.37</span>, <span class="fl">0.58</span>, <span class="fl">0.42</span>, <span class="fl">0.80</span>, <span class="fl">0.88</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">bot</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>, xpd<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Tiahura-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Species presence graph set:</span></span></span>
<span class="r-in"><span><span class="va">plot_slice</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sl</span>,<span class="va">split</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">species</span><span class="op">)</span><span class="op">/</span><span class="va">split</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">sp_slice</span> <span class="op">&lt;-</span> <span class="va">size</span><span class="op">*</span><span class="op">(</span><span class="va">sl</span> <span class="op">-</span> <span class="fl">1L</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1L</span><span class="op">:</span><span class="va">size</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span>z<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">fish</span><span class="op">[</span>,<span class="va">sp_slice</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,y<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">fish</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        x<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sp_slice</span><span class="op">)</span>,zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>,col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>,<span class="st">"black"</span><span class="op">)</span>,axes<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>        ylab<span class="op">=</span><span class="st">""</span>,xlab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1L</span>,at<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sp_slice</span><span class="op">)</span>,labels<span class="op">=</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">species</span><span class="op">[</span><span class="va">sp_slice</span><span class="op">]</span>,las<span class="op">=</span><span class="fl">2L</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2L</span>,at<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">fish</span><span class="op">)</span>,label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">Tiahura</span><span class="op">$</span><span class="va">fish</span><span class="op">)</span>,las<span class="op">=</span><span class="fl">1L</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>,<span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_slice</span><span class="op">(</span><span class="fl">1L</span>,<span class="fl">5L</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Tiahura-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">## plot_slice(2L,5L)</span></span></span>
<span class="r-in"><span><span class="co">## plot_slice(3L,5L)</span></span></span>
<span class="r-in"><span><span class="co">## plot_slice(4L,5L)</span></span></span>
<span class="r-in"><span><span class="co">## plot_slice(5L,5L)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stéphane Dray, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

