<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plots of the outputs of a temporal beta diversity analysis — plot.TBI • adespatial</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plots of the outputs of a temporal beta diversity analysis — plot.TBI"><meta property="og:description" content="B-C plots are an important step in temporal beta diversity analysis. This function
draws B-C plots from the output of function TBI. Different graphic options are
available."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-27</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/adeverse/adespatial/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plots of the outputs of a temporal beta diversity analysis</h1>
    <small class="dont-index">Source: <a href="https://github.com/adeverse/adespatial/blob/v0.3-27/R/plot.TBI.R" class="external-link"><code>R/plot.TBI.R</code></a></small>
    <div class="hidden name"><code>plot.TBI.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>B-C plots are an important step in temporal beta diversity analysis. This function
draws B-C plots from the output of function TBI. Different graphic options are
available.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'TBI'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"BC"</span>,</span>
<span>  s.names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pch.loss <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  pch.gain <span class="op">=</span> <span class="fl">22</span>,</span>
<span>  cex.names <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  col.rim <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  col.bg <span class="op">=</span> <span class="st">"gold1"</span>,</span>
<span>  cex.symb <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  diam <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  main <span class="op">=</span> <span class="st">"B-C plot"</span>,</span>
<span>  cex.main <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cex.lab <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  xlim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ylim <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Output of a temporal beta diversity analysis with function TBI.
The matrix BCD.mat will be extracted from that object. This matrix contains the
B/den statistics in column 1 and the C/den statistics in column 2, where "den" is the
denominator used in the TBI analysis.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Specify which outputs are plotted. At this time, only BC plots are implemented</p></dd>


<dt id="arg-s-names">s.names<a class="anchor" aria-label="anchor" href="#arg-s-names"></a></dt>
<dd><p>a vector of names: Site names will be printed on the BC plot. Examples:
s.names=1:25; s.names=paste("Site",1:25,sep="."); s.names=rownames(res1$BCD.mat).
Else, s.names=NULL (default): no site names will be printed.</p></dd>


<dt id="arg-pch-loss">pch.loss<a class="anchor" aria-label="anchor" href="#arg-pch-loss"></a></dt>
<dd><p>Symbol used for sites where losses &gt; gains. Default: pch=21, circles.
Symbols 21 to 25 have a black rim and can be filled with different colours (argument
col.bg); see documentation of function points. Symbols 0 to 20 only have a rim.</p></dd>


<dt id="arg-pch-gain">pch.gain<a class="anchor" aria-label="anchor" href="#arg-pch-gain"></a></dt>
<dd><p>Symbol used for sites where losses &gt;= gains. Default: pch=21, squares.</p></dd>


<dt id="arg-cex-names">cex.names<a class="anchor" aria-label="anchor" href="#arg-cex-names"></a></dt>
<dd><p>Multiplier for the font size of the site names.</p></dd>


<dt id="arg-col-rim">col.rim<a class="anchor" aria-label="anchor" href="#arg-col-rim"></a></dt>
<dd><p>Colour of symbol rims in the plot. The following colours have been used
in BC plots: <code>"gold","grey70","cadetblue2","red","orange3","coral2","grey100","green"</code>.</p></dd>


<dt id="arg-col-bg">col.bg<a class="anchor" aria-label="anchor" href="#arg-col-bg"></a></dt>
<dd><p>Colour filling symbols 21 to 25 in the plot.</p></dd>


<dt id="arg-cex-symb">cex.symb<a class="anchor" aria-label="anchor" href="#arg-cex-symb"></a></dt>
<dd><p>Multiplier for size of the symbols representing the TBI values of the
sites in the plot. With cex.symb=NULL, symbols have small and uniform sizes.</p></dd>


<dt id="arg-diam">diam<a class="anchor" aria-label="anchor" href="#arg-diam"></a></dt>
<dd><p>If  <code>TRUE</code>, symbol diameter represents the TBI value. If <code>FALSE</code>,
symbol surface area represents the TBI value.</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>Main title above the plot. Change the title and adapt it to your study.</p></dd>


<dt id="arg-cex-main">cex.main<a class="anchor" aria-label="anchor" href="#arg-cex-main"></a></dt>
<dd><p>Multiplier for the font size of the main title.</p></dd>


<dt id="arg-cex-lab">cex.lab<a class="anchor" aria-label="anchor" href="#arg-cex-lab"></a></dt>
<dd><p>Multiplier for the font size of the labels.</p></dd>


<dt id="arg-xlim">xlim<a class="anchor" aria-label="anchor" href="#arg-xlim"></a></dt>
<dd><p>The x limits of the plot, e.g. c(0,1).</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>The y limits of the plot, e.g. c(0,1).</p></dd>


<dt id="arg-silent">silent<a class="anchor" aria-label="anchor" href="#arg-silent"></a></dt>
<dd><p>If <code>FALSE</code> print intercept of red line with ordinate.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments to be passed to the function</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A graph in the R graphic window, with the same scale along the 2 axes (asp=1).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>B-C plots are an informative output of temporal beta diversity analysis. The
species losses (B statistics) form the abscissa and the gains (C statistics) are on the
ordinate of the plot. The objective is to illustrate whether the temporal changes at
the various sites are dominated by gains or by losses. Distinctive symbols are used for
the sites dominated by gains (default: squares) and by losses (default: circles). The
symbols are drawn to sizes representing the values of the D = (B+C) statistics.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Legendre, P. 2019. A temporal beta-diversity index to identify sites that have changed
in exceptional ways in space-time surveys. <em>Ecology and Evolution</em> (in press).</p>
<p>van den Brink, P. J. &amp; C. J. F. ter Braak. 1999. Principal response curves: analysis of
time-dependent multivariate responses of biological community to stress.
<em>Environmental Toxicology and Chemistry</em> 18: 138-148.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="TBI.html">TBI</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Pierre Legendre <a href="mailto:pierre.legendre@umontreal.ca">pierre.legendre@umontreal.ca</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://github.com/vegandevs/vegan" class="external-link">"vegan"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 1 -</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Invertebrate communities subjected to insecticide treatment.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## As an example in their paper on Principal Response Curves (PRC method), van den </span></span></span>
<span class="r-in"><span><span class="co">## Brink &amp; ter Braak (1999) used observations on the abundances of 178 invertebrate </span></span></span>
<span class="r-in"><span><span class="co">## species (macroinvertebrates and zooplankton) subjected to treatments in 12 mesocosms </span></span></span>
<span class="r-in"><span><span class="co">## by the insecticide chlorpyrifos. The mesocosms were sampled at 11 occasions. The </span></span></span>
<span class="r-in"><span><span class="co">## data, available in the {vegan} package, are log-transformed species abundances, </span></span></span>
<span class="r-in"><span><span class="co">## ytranformed = loge(10*y+1).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The data of survey #4 will be compared to those of survey #11 in this example. </span></span></span>
<span class="r-in"><span><span class="co">## Survey #4 was carried out one week after the insecticide treatment, whereas the  </span></span></span>
<span class="r-in"><span><span class="co">## fauna of the mesocosms was considered by the authors to have fully recovered from  </span></span></span>
<span class="r-in"><span><span class="co">## the insecticide treatment at survey #11.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pyrifos</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The mesocosms had originally been attributed at random to the treatments. However, </span></span></span>
<span class="r-in"><span><span class="co">## to facilitate presentation of the results, they will be listed here in order of </span></span></span>
<span class="r-in"><span><span class="co">## increased insecticide doses: {0, 0, 0, 0, 0.1, 0.1, 0.9, 0.9, 6, 6, 44, 44} </span></span></span>
<span class="r-in"><span><span class="co">## micro g/L.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Select the 12 data rows of surveys 4 and 11 from the data file and reorder them</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ord4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">38</span>,<span class="fl">39</span>,<span class="fl">41</span>,<span class="fl">47</span>,<span class="fl">37</span>,<span class="fl">44</span>,<span class="fl">40</span>,<span class="fl">46</span>,<span class="fl">43</span>,<span class="fl">48</span>,<span class="fl">42</span>,<span class="fl">45</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ord11</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">122</span>,<span class="fl">123</span>,<span class="fl">125</span>,<span class="fl">131</span>,<span class="fl">121</span>,<span class="fl">128</span>,<span class="fl">124</span>,<span class="fl">130</span>,<span class="fl">127</span>,<span class="fl">132</span>,<span class="fl">126</span>,<span class="fl">129</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Run the TBI function</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res1</span> <span class="op">&lt;-</span> <span class="fu"><a href="TBI.html">TBI</a></span><span class="op">(</span><span class="va">pyrifos</span><span class="op">[</span><span class="va">ord4</span>,<span class="op">]</span>, <span class="va">pyrifos</span><span class="op">[</span><span class="va">ord11</span>,<span class="op">]</span>, method <span class="op">=</span> <span class="st">"%diff"</span>, nperm <span class="op">=</span> <span class="fl">0</span>, test.t.perm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res1</span><span class="op">$</span><span class="va">BCD.mat</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Draw BC plots</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">s.names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Surv"</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,sep<span class="op">=</span><span class="st">"."</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## In the 1st plot, the symbols have diameters proportional to the site TBI statistics </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res1</span>, s.names<span class="op">=</span><span class="va">s.names</span>, col.bg<span class="op">=</span><span class="st">"red"</span>, pch.loss<span class="op">=</span><span class="fl">21</span>, pch.gain<span class="op">=</span><span class="fl">22</span>, </span></span>
<span class="r-in"><span>main<span class="op">=</span><span class="st">"B-C plot, Pyrifos, surveys 4 &amp; 11"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## In the 2nd plot, control the axes limit values by specifying xlim and ylim</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res1</span>, s.names<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, col.bg<span class="op">=</span><span class="st">"green"</span>, pch.loss<span class="op">=</span><span class="fl">23</span>, pch.gain<span class="op">=</span><span class="fl">24</span>, </span></span>
<span class="r-in"><span>main<span class="op">=</span><span class="st">"B-C plot, Pyrifos, surveys 4 &amp; 11"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.5</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>,<span class="fl">0.6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## In the 3rd plot, draw all symbols small and of the same size, using cex.symb=NULL</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res1</span>, s.names<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span>, col.bg<span class="op">=</span><span class="st">"gold"</span>, pch.loss<span class="op">=</span><span class="fl">23</span>, pch.gain<span class="op">=</span><span class="fl">24</span>, </span></span>
<span class="r-in"><span>main<span class="op">=</span><span class="st">"B-C plot, Pyrifos, surveys 4 &amp; 11"</span>, cex.symb<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 2 -</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## This example uses the mite data available in vegan. Let us pretend that sites 1-20 </span></span></span>
<span class="r-in"><span><span class="co">## represent a survey at time 1 (T1) and sites 21-40 a survey at time 2 (T2).</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Run the TBI function</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="TBI.html">TBI</a></span><span class="op">(</span><span class="va">mite</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>,<span class="op">]</span>,<span class="va">mite</span><span class="op">[</span><span class="fl">21</span><span class="op">:</span><span class="fl">40</span>,<span class="op">]</span>,method<span class="op">=</span><span class="st">"%diff"</span>,nperm<span class="op">=</span><span class="fl">0</span>,test.t.perm<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res2</span><span class="op">$</span><span class="va">BCD.mat</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Draw BC plots</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">s.names</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">res2</span><span class="op">$</span><span class="va">BCD.mat</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## In the 1st plot, the symbols have diameters proportional to the site TBI statistics</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res2</span>, s.names<span class="op">=</span><span class="va">s.names</span>, col.bg<span class="op">=</span><span class="st">"cadetblue2"</span>, pch.loss<span class="op">=</span><span class="fl">21</span>, pch.gain<span class="op">=</span><span class="fl">22</span>, </span></span>
<span class="r-in"><span>main<span class="op">=</span><span class="st">"B-C plot, Mite data"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In the 2nd plot, control the axes limit values by specifying xlim and ylim</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res2</span>, s.names<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, col.rim<span class="op">=</span><span class="st">"coral2"</span>, pch.loss<span class="op">=</span><span class="fl">19</span>, pch.gain<span class="op">=</span><span class="fl">15</span>, </span></span>
<span class="r-in"><span>main<span class="op">=</span><span class="st">"B-C plot, Mite data"</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.6</span><span class="op">)</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-plt img"><img src="plot.TBI-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot.TBI-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="plot.TBI-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stéphane Dray, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

