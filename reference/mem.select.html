<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Selection of the best subset of spatial eigenvectors (MEM, Moran's Eigenvector Maps) — mem.select • adespatial</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Selection of the best subset of spatial eigenvectors (MEM, Moran's Eigenvector Maps) — mem.select"><meta property="og:description" content='mem.select computes the spatial eigenvectors (MEM) of the spatial
weighting matrix (SWM) provided (listw) and optimizes the selection of
a subset of MEM variables relative to response variable(s) stored in
x. The optimization is done either by maximizing the adjusted
R-squared (R2) of all (method = "global") or a subset (method =
"FWD") of MEM variables or by minimizing the residual spatial
autocorrelation (method = "MIR") (see details in Bauman et al. 2018a).'><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-25</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/adeverse/adespatial/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Selection of the best subset of spatial eigenvectors (MEM, Moran's Eigenvector Maps)</h1>
    <small class="dont-index">Source: <a href="https://github.com/adeverse/adespatial/blob/master/R/mem.select.R" class="external-link"><code>R/mem.select.R</code></a></small>
    <div class="hidden name"><code>mem.select.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>mem.select</code> computes the spatial eigenvectors (MEM) of the spatial
weighting matrix (SWM) provided (<code>listw</code>) and optimizes the selection of
a subset of MEM variables relative to response variable(s) stored in
<code>x</code>. The optimization is done either by maximizing the adjusted
R-squared (R2) of all (<code>method = "global"</code>) or a subset (<code>method =
"FWD"</code>) of MEM variables or by minimizing the residual spatial
autocorrelation (<code>method = "MIR"</code>) (see details in Bauman et al. 2018a).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mem.select</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">listw</span>,</span>
<span>  MEM.autocor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"positive"</span>, <span class="st">"negative"</span>, <span class="st">"all"</span><span class="op">)</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FWD"</span>, <span class="st">"MIR"</span>, <span class="st">"global"</span><span class="op">)</span>,</span>
<span>  MEM.all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nperm <span class="op">=</span> <span class="fl">999</span>,</span>
<span>  nperm.global <span class="op">=</span> <span class="fl">9999</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A vector, matrix, or dataframe of response variable(s). The
<code>method = "MIR"</code> is only implemented for a vector response. Note that
<code>x</code> can also contain the residuals of a model when other (e.g.,
environmental) variables should be considered in the model.</p></dd>


<dt id="arg-listw">listw<a class="anchor" aria-label="anchor" href="#arg-listw"></a></dt>
<dd><p>A spatial weighting matrix of class <code>listw</code>; can be created
with functions of the package <code>spdep</code>, or with the user-friendly
function <code>listw.candidates</code>. Note that, the function <code>listw.candidates</code>
returns a <code>list</code> of <code>listw</code> and subselection by <code>[[]]</code> should be
performed in this case (see <code>Example</code>)</p></dd>


<dt id="arg-mem-autocor">MEM.autocor<a class="anchor" aria-label="anchor" href="#arg-mem-autocor"></a></dt>
<dd><p>Sign of the spatial eigenvectors to generate; "positive",
"negative", or "all", for positively, negatively autocorrelated
eigenvectors, or both, respectively; default is "positive"</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Criterion to select the best subset of MEM variables. Either
<code>"FWD"</code> (default option), <code>"MIR"</code> (for univariate <code>x</code>
only), or <code>"global"</code> (see <code>Details</code>)</p></dd>


<dt id="arg-mem-all">MEM.all<a class="anchor" aria-label="anchor" href="#arg-mem-all"></a></dt>
<dd><p>A logical indicating if the complete set of MEM variables
should be returned</p></dd>


<dt id="arg-nperm">nperm<a class="anchor" aria-label="anchor" href="#arg-nperm"></a></dt>
<dd><p>Number of permutations to perform the tests in the selection
procedure; Default is 999</p></dd>


<dt id="arg-nperm-global">nperm.global<a class="anchor" aria-label="anchor" href="#arg-nperm-global"></a></dt>
<dd><p>Number of permutations to perform the tests in the global test;
Default is 9999</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Significance threshold value for the tests; Default is 0.05</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>If 'TRUE' more diagnostics are printed. The default setting is
FALSE</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other parameters (for internal use with <code>listw.select</code>)</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The function returns a list with:</p><dl><dt>global.test</dt>
<dd><p>An
  object of class <code>randtest</code> containing the result of the global test
  associated to all MEM (adjusted R2 and p-value). If <code>MEM.autocor = "all"</code>,
  a list with two elements (<code>positive</code> and <code>negative</code>) corresponding to
  the results of the global tests performed on positive and negative MEM respectively.</p></dd>

  <dt>MEM.all</dt>
<dd><p>An object of class <code>orthobasisSp</code> containing the
  complete set of generated MEM variables (generated by
  <code><a href="mem.html">scores.listw</a></code>). Only returned if <code>MEM.all = TRUE</code>.</p></dd>

  <dt>summary</dt>
<dd><p>A dataframe summarizing the results of the selection
  procedure</p></dd>
 <dt>MEM.select</dt>
<dd><p>An object of class <code>orthobasisSp</code>
  containing the subset of significant MEM variables.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function provides three different methods to select a subset of
  MEM variables. For all methods, a global test is firstly performed. If
  <code>MEM.autocor = "all"</code>, two global tests are performed and p-values are
  corrected for multiple comparison (Sidak correction).</p>
<p>If the MEM variables are to be further used in a model including actual
  predictors (e.g. environmental), then a subset of spatial eigenvectors
  needs to be selected before proceeding to further analyses to avoid model
  overfitting and/or a loss of statistical power to detect the contribution of
  the environment to the variability of the response data (Griffith 2003, Dray
  et al. 2006, Blanchet et al. 2008, Peres-Neto and Legendre 2010, Diniz-Filho
  et al. 2012). Although several eigenvector selection approaches have been
  proposed to select a best subset of eigenvectors, Bauman et al. (2018b) showed
  that two main procedures should be preferred, depending on the underlying
  objective: the forward selection with double stopping criterion (Blanchet et
  al. 2008; <code>method = "FWD"</code>) or the minimization of the residual spatial
  autocorrelation (Griffith and Peres-Neto 2006; MIR selection in Bauman et al.
  2018a,b, <code>method = "MIR"</code>).
  The most powerful and accurate selection method, in terms of R2 estimation,
  is the forward selection. This method should be preferred when the objective
  is to capture as accurately as possible the spatial patterns of <code>x</code>. If
  the objective is to optimize the detection of the spatial patterns in the
  residuals of a model of the response variable(s) against a set of environmental
  predictors, for instance, then <code>x</code> should be the model residuals, and
  <code>method = "FWD"</code>. This allows optimizing the detection of residual
  spatial patterns once the effect of the environmental predictors has been
  removed.
  If however the objective is only to remove the spatial autocorrelation from the
  residuals of a model of <code>x</code> against a set of actual predictors (e.g.
  environmental) with a small number of spatial predictors, then accuracy is
  not as important and one should focus mainly on the number of spatial
  predictors (Bauman et al. 2018b). In this case, <code>method = "MIR"</code> is more
  adapted, as it has the advantage to maintain the standard errors of the actual
  predictor coefficients as low as possible. Note that <code>method = "MIR"</code> can
  only be used for a univariate <code>x</code>, as the Moran's I is a univariate index.
  If <code>x</code> is multivariate, then the best criterion is the forward selection
  (see Bauman et al. 2018b).
  A third option is to not perform any selection of MEM variables
  (<code>method = "global"</code>). This option may be interesting when the complete set
  of MEM variables will be used, like in Moran spectral randomizations (Wagner and
  Dray 2015, Bauman et al. 2018c) or when using smoothed MEM (Munoz 2009).</p>
<p>For <code>method = "MIR"</code>, the global test consists in computing the
  Moran's I of <code>x</code> (e.g. residuals of the model of the response variable
  against environmental variables) and tests it by permutation (results
  stored in <code>global.test</code>). If the Moran's I is significant, the
  function performs a selection procedure that searches among the set of
  generated spatial predictors the one that best minimizes the value of the
  Moran's I. A model of <code>x</code> against the selected eigenvector is built,
  and the significance of the Moran's I of the model residuals is tested
  again. The procedure goes on until the Moran's I of the model residuals is
  not significant anymore, hence the name of Minimization of moran's I in the
  Residuals (MIR).</p>
<p>For <code>method = "global"</code> and <code>method = "FWD"</code>, the global test
  consists in computing the adjusted global R2, that is, the R2 of the model
  of <code>x</code> against the whole set of generated MEM variables and tests it
  by permutation (results stored in <code>global.test</code>).</p>
<p>For <code>method = "global"</code>, if the adjusted global R2 is significant, the
  functions returns the whole set of generated MEM variables in <code>MEM.select</code>.</p>
<p>For <code>method = "FWD"</code>, if the adjusted global R2 is significant, the
  function performs a forward selection with double stopping criterion that
  searches among the set of generated spatial predictors the one that best maximizes
  the R2 of the model. The procedure is repeated untill one of the two stopping
  criterion is reached (see Blanchet et al. 2008). Note that in a few cases, the forward
  selection does not select any variable even though the global model is significant. This
  can happen for example when a single variable has a strong relation with the response
  variable(s), because the integration of the variable alone yields an adjusted R2
  slightly higher than the global adjusted R2. In this case, we recommend checking that this
  is indeed the reason why the first selected variable was rejected, and rerun the analysis
  with a second stopping criterion equal to the global adjusted R2 plus a small amount
  allowing avoiding this issue (e.g. 5<!-- % of the global adjusted R2). For now, this can be  -->
  done through the argument <code>adjR2thresh</code> of function <code>forward.sel</code>, until the
  solution is implemented in <code>mem.select</code>.</p>
<p>For the <code>method = "FWD"</code> and <code>method = "MIR"</code>, the MEM selected
  by the procedure are returned in <code>MEM.select</code> and a summary of the
  results is provided in <code>summary</code>. If no MEM are selected, then
  <code>MEM.select</code> and <code>summary</code> are not returned.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Bauman D., Fortin M-J, Drouet T. and Dray S. (2018a) Optimizing the choice
of a spatial weighting matrix in eigenvector-based methods. Ecology, 99, 2159-2166</p>
<p>Bauman D., Drouet T., Dray S. and Vleminckx J. (2018b) Disentangling good from
bad practices in the selection of spatial or phylogenetic eigenvectors.
Ecography, 41, 1–12</p>
<p>Bauman D., Vleminckx J., Hardy O., Drouet T. (2018c) Testing and interpreting the
shared space-environment fraction in variation partitioning analyses of ecological data.
Oikos</p>
<p>Blanchet G., Legendre P. and Borcard D. (2008) Forward selection of
explanatory variables. Ecology, 89(9), 2623–2632</p>
<p>Diniz-Filho J.A.F., Bini L.M., Rangel T.F., Morales-Castilla I. et al.
(2012) On the selection of phylogenetic eigenvectors for ecological
analyses. Ecography, 35, 239–249</p>
<p>Dray S., Legendre P. and Peres-Neto P. R. (2006) Spatial modeling: a
comprehensive framework for principal coordinate analysis of neighbor
matrices (PCNM). Ecological Modelling, 196, 483–493</p>
<p>Griffith D. (2003) Spatial autocorrelation and spatial filtering: gaining
understanding through theory and scientific visualization. Springer, Berlin</p>
<p>Griffith D. and Peres-Neto P. (2006) Spatial modeling in Ecology: the
flexibility of eigenfunction spatial analyses. Ecology, 87, 2603–2613</p>
<p>Munoz, F. 2009. Distance-based eigenvector maps (DBEM) to analyse
metapopulation structure with irregular sampling. Ecological Modelling, 220,
2683–2689</p>
<p>Peres-Neto P. and Legendre P. (2010) Estimating and controlling for spatial
structure in the study of ecological communities. Global Ecology and
Biogeography, 19, 174–184</p>
<p>Wagner H., Dray S. (2015). Generating spatially constrained null models for
irregularly spaced data using Moran spectral randomization methods. Methods
in Ecology and Evolution, 6, 1169–1178</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="listw.candidates.html">listw.candidates</a></code>, <code><a href="listw.select.html">listw.select</a></code>,
  <code><a href="mem.html">scores.listw</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>David Bauman (<a href="mailto:dbauman@ulb.ac.be">dbauman@ulb.ac.be</a> or
  <a href="mailto:davbauman@gmail.com">davbauman@gmail.com</a>) and Stéphane Dray</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vegandevs/vegan" class="external-link">vegan</a></span><span class="op">)</span><span class="op">)</span><span class="op">{</span> </span></span>
<span class="r-in"><span><span class="co"># Illustration of the MIR selection on the oribatid mite data</span></span></span>
<span class="r-in"><span><span class="co"># (Borcard et al. 1992, 1994 for details on the dataset):</span></span></span>
<span class="r-in"><span><span class="co"># *******************************************************</span></span></span>
<span class="r-in"><span><span class="co"># Community data (response matrix):</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># We will compute the example on a single species:</span></span></span>
<span class="r-in"><span><span class="va">spe</span> <span class="op">&lt;-</span> <span class="va">mite</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co"># Environmental explanatory dataset:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite.env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># We only use two numerical explanatory variables:</span></span></span>
<span class="r-in"><span><span class="va">env</span> <span class="op">&lt;-</span> <span class="va">mite.env</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Coordinates of the 70 sites:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite.xy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">coord</span> <span class="op">&lt;-</span> <span class="va">mite.xy</span></span></span>
<span class="r-in"><span><span class="co"># We build the model we are interested in:</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">spe</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">env</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># In order to avoid possible type I error rate inflation issues, we check </span></span></span>
<span class="r-in"><span><span class="co"># whether the model residuals are independent, and if they are spatially</span></span></span>
<span class="r-in"><span><span class="co"># autocorrelated, we select a small subset of MEM variables to add to the</span></span></span>
<span class="r-in"><span><span class="co"># model as covariables with the MIR selection:</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1) We build a spatial weighting matrix based on Gabriel graph with a</span></span></span>
<span class="r-in"><span><span class="co"># weighting function decreasing linearly with the distance:</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="listw.candidates.html">listw.candidates</a></span><span class="op">(</span><span class="va">coord</span>, nb <span class="op">=</span> <span class="st">"gab"</span>, weights <span class="op">=</span> <span class="st">"flin"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2) We test the spatial autocorrelation of the model residuals and, if</span></span></span>
<span class="r-in"><span><span class="co"># necessary, select a subset of spatial predictors:</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">MEM</span> <span class="op">&lt;-</span> <span class="fu">mem.select</span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span>, listw <span class="op">=</span> <span class="va">w</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, method <span class="op">=</span> <span class="st">"MIR"</span>, MEM.autocor <span class="op">=</span> <span class="st">"positive"</span>,</span></span>
<span class="r-in"><span>         nperm <span class="op">=</span> <span class="fl">999</span>, alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">MEM</span><span class="op">$</span><span class="va">MEM.select</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># The residuals of the model presented spatial autocorrelation. The selection</span></span></span>
<span class="r-in"><span><span class="co"># of MEM variables is thus performed to remove residual autocorrelation.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3) We can reconstruct our model adding the selected MEM variable as covariables:</span></span></span>
<span class="r-in"><span><span class="va">env2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">env</span>, <span class="va">MEM</span><span class="op">$</span><span class="va">MEM.select</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mod_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">spe</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">env2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_complete</span><span class="op">)</span><span class="op">$</span><span class="va">coefficient</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span>   <span class="co"># Coefficient estimates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mod_complete</span><span class="op">)</span><span class="op">$</span><span class="va">coefficient</span><span class="op">[</span>, <span class="fl">2</span><span class="op">]</span>   <span class="co"># Standard errors</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)    SubsDens    WatrCont        MEM6        MEM5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.763474835 0.017891034 0.001448202 0.198312047 0.191102035 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stéphane Dray, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

