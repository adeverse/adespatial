<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Dissimilarity matrices for community composition data — dist.ldc • adespatial</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Dissimilarity matrices for community composition data — dist.ldc"><meta property="og:description" content="Compute dissimilarity indices for ecological data matrices. The dissimilarity
indices computed by this function are those described in Legendre and De
Cáceres (2013). In the name of the function, 'ldc' stands for the author's
names. Twelve of these 21 indices are not readily available in other R
package functions; four of them can, however, be computed in two computation
steps in vegan."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-22</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sdray/adespatial/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Dissimilarity matrices for community composition data</h1>
    <small class="dont-index">Source: <a href="https://github.com/sdray/adespatial/blob/HEAD/R/dist.ldc.R" class="external-link"><code>R/dist.ldc.R</code></a></small>
    <div class="hidden name"><code>dist.ldc.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute dissimilarity indices for ecological data matrices. The dissimilarity
indices computed by this function are those described in Legendre and De
Cáceres (2013). In the name of the function, 'ldc' stands for the author's
names. Twelve of these 21 indices are not readily available in other R
package functions; four of them can, however, be computed in two computation
steps in <code>vegan</code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dist.ldc</span><span class="op">(</span><span class="va">Y</span>, method <span class="op">=</span> <span class="st">"hellinger"</span>, binary <span class="op">=</span> <span class="cn">FALSE</span>, samp <span class="op">=</span> <span class="cn">TRUE</span>, silent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>Y</dt>
<dd><p>Community composition data. The object class can be either
<code>data.frame</code> or <code>matrix</code>.</p></dd>


<dt>method</dt>
<dd><p>One of the 21 dissimilarity coefficients available in the
function: <code>"hellinger"</code>, <code>"chord"</code>, <code>"log.chord"</code>,
<code>"chisquare"</code>, <code>"profiles"</code>, <code>"percentdiff"</code>,
<code>"ruzicka"</code>, <code>"divergence"</code>, <code>"canberra"</code>,
<code>"whittaker"</code>, <code>"wishart"</code>, <code>"kulczynski"</code>,
<code>"jaccard"</code>, <code>"sorensen"</code>, <code>"ochiai"</code>, <code>"ab.jaccard"</code>,
<code>"ab.sorensen"</code>, <code>"ab.ochiai"</code>, <code>"ab.simpson"</code>,
<code>"euclidean"</code>, <code>"manhattan"</code>, <code>"modmeanchardiff"</code>. See
Details. Names can be abbreviated to a non-ambiguous set of first letters.
Default: <code>method="hellinger"</code>.</p></dd>


<dt>binary</dt>
<dd><p>If <code>binary=TRUE</code>, the data are transformed to
presence-absence form before computation of the dissimilarities. Default
value: <code>binary=FALSE</code>, except for the Jaccard, Sørensen and Ochiai
indices where <code>binary=TRUE</code>.</p></dd>


<dt>samp</dt>
<dd><p>If <code>samp=TRUE</code>, the abundance-based distances (ab.jaccard,
ab.sorensen, ab.ochiai, ab.simpson) are computed for sample data. If
<code>samp=FALSE</code>, binary indices are computed for true population data.</p></dd>


<dt>silent</dt>
<dd><p>If <code>silent=FALSE</code>, informative messages sent to users will
be printed to the R console. Use <code>silent=TRUE</code> is called on a
numerical simulation loop, for example.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A dissimilarity matrix, with class <code>dist</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The dissimilarities computed by this function are the following.
  Indices i and k designate two rows (sites) of matrix Y, j designates a
  column (species). D[ik] is the dissimilarity between rows i and k. p is the
  number of columns (species) in Y; pp is the number of species present in
  one or the other site, or in both. y[i+] is the sum of values in row i;
  same for y[k+]. y[+j] is the sum of values in column j. y[++] is the total
  sum of values in Y. The indices are computed by functions written in C for
  greater computation speed with large data matrices.</p><ul><li><p>Group 1
  - D computed by transformation of Y followed by Euclidean distance</p><ul><li><p>Hellinger D, D[ik] =
  sqrt(sum((sqrt(y[ij]/y[i+])-sqrt(y[kj]/y[k+]))^2))</p></li>
<li><p>chord D, D[ik] =
  sqrt(sum((y[ij]/sqrt(sum(y[ij]^2))-y[kj]/sqrt(sum(y[kj]^2)))^2))</p></li>
<li><p>log-chord D, D[ik] = chord D[ik] computed on log(y[ij]+1)-transformed data
  (Legendre and Borcard 2018)</p></li>
<li><p>chi-square D, D[ik] = sqrt(y[++]
  sum((1/j[+j])(y[ij]/y[i+]-y[kj]/y[k+])^2))</p></li>
<li><p>species profiles D, D[ik]
  = sqrt(sum((y[ij]/y[i+]-y[kj]/y[k+])^2))</p></li>
</ul></li>
<li><p>Group 2 - Other D functions appropriate for beta diversity studies
  where A = sum(min(y[ij],y[kj])), B = y[i+]-A, C = y[k+]-A</p><ul><li><p>Ružička D, D[ik] = 1-(sum(min(y[ij],y[kj])/sum(max(y[ij],y[kj])) or
  else, D[ik] = (B+C)/(A+B+C)</p></li>
<li><p>coeff. of divergence D, D[ik] =
  sqrt((1/pp)sum(((y[ij]-y(kj])/(y[ij]+y(kj]))^2))</p></li>
<li><p>Canberra metric D,
  D[ik] = (1/pp)sum(abs(y[ij]-y(kj])/(y[ij]+y(kj]))</p></li>
<li><p>Whittaker D, D[ik]
  = 0.5*sum(abs(y[ij]/y[i+]-y(kj]/y[k+]))</p></li>
<li><p>Wishart D, D[ik] =
  1-sum(y[ij]y[kj])/(sum(y[ij]^2)+sum(y[kj]^2)-sum(y[ij]y[kj]))</p></li>
<li><p>Kulczynski D, D[ik] =
  1-0.5((sum(min(y[ij],y[kj])/y[i+]+sum(min(y[ij],y[kj])/y[k+]))</p></li>
</ul></li>
<li><p>Group 3 - Classical indices for binary data; they are appropriate for
  beta diversity studies. Value a is the number of species found in both i
  and k, b is the number of species in site i not found in k, and c is the
  number of species found in site k but not in i. The D matrices are
  square-root transformed, as in dist.binary of ade4; the user-oriented
  reason for this transformation is explained below.</p><ul><li><p>Sørensen D, D[ik] =
  sqrt((b+c)/(2a+b+c))</p></li>
<li><p>Ochiai D, D[ik] = sqrt(1 - a/sqrt((a+b)(a+c)))</p></li>
</ul></li>
<li><p>Group 4 - Abundance-based indices of Chao et al. (2006) for
  quantitative abundance data. These functions correct the index for species
  that have not been observed due to sampling errors. For the meaning of the
  U and V notations, see Chao et al. (2006, section 3). When
  <code>samp=TRUE</code>, the abundance-based distances (ab.jaccard, ab.sorensen,
  ab.ochiai, ab.simpson) are computed for sample data. If <code>samp=FALSE</code>,
  indices are computed for true population data. - Do not use indices of
  group 4 with <code>samp=TRUE</code> on presence-absence data; the indices are not
  meant to accommodate this type of data. If <code>samp=FALSE</code> is used with
  presence-absence data, the indices are the regular Jaccard, Sorensen,
  Ochiai, Simpson indices. On output, however, the D matrices are not
  square-rooted, contrary to the Jaccard, Sorensen, Ochiai indices in
  section 3 which are square-rooted.</p><ul><li><p>abundance-based Sørensen D, D[ik] =
  1-(2UV/(U+V))</p></li>
<li><p>abundance-based Ochiai D, D[ik] = 1-sqrt(UV)</p></li>
<li><p>abundance-based Simpson D, D[ik] = 1-(UV/(UV+min((U-UV),(V-UV))))</p></li>
</ul></li>
<li><p>Group 5 - General-purpose dissimilarities that do not have an upper
  bound (maximum D value). They are inappropriate for beta diversity studies.</p><ul><li><p>Manhattan D, D[ik] = sum(abs(y[ij] - y[ik]))</p></li>
<li><p>modified mean character
  difference, D[ik] = (1/pp) sum(abs(y[ij] - y[ik]))</p></li>
</ul></li>
</ul><p>The properties of
  all dissimilarities available in this function (except Ružička D) were
  described and compared in Legendre &amp; De Cáceres (2013), who showed that
  most of these dissimilarities are appropriate for beta diversity studies.
  Inappropriate are the Euclidean, Manhattan, modified mean character
  difference, species profile and chi-square distances. Most of these
  dissimilarities have a maximum value of either 1 or sqrt(2). Three
  dissimilarities (Euclidean, Manhattan, Modified mean character difference)
  do not have an upper bound and are thus inappropriate for beta diversity
  studies. The chi-square distance has an upper bound of
  sqrt(2*(sum(Y))).<br><br> The Euclidean, Hellinger, chord, chi-square and
  species profiles dissimilarities have the property of being Euclidean,
  meaning that they never produce negative eigenvalues in principal
  coordinate analysis. The Canberra, Whittaker, percentage difference,
  Wishart and Manhattan coefficients are Euclidean when they are square-root
  transformed (Legendre &amp; De Cáceres 2013, Table 2). The distance forms (1-S)
  of the Jaccard, Sørensen and Ochiai similarity (S) coefficients are
  Euclidean after taking the square root of (1-S) (Legendre &amp; Legendre 2012,
  Table 7.2). The D matrices resulting from these three coefficients are
  outputted in the form sqrt(1-S), as in function <code>dist.binary</code> of ade4,
  because that form is Euclidean and will thus produce no negative
  eigenvalues in principal coordinate analysis. <br><br> The Hellinger, chord,
  chi-square and species profile dissimilarities are computed using the
  two-step procedure developed by Legendre &amp; Gallagher (2001). The data are
  first transformed using either the row marginals, or the row and column
  marginals in the case of the chi-square distance. The dissimilarities are
  then computed from the transformed data using the Euclidean distance
  formula. As a consequence, these four dissimilarities are necessarily
  Euclidean. D matrices for other binary coefficients can be computed in two
  ways: either by using function <code>dist.binary</code> of ade4, or by choosing
  option <code>binary=TRUE</code>, which transforms the abundance data to binary
  form, and using one of the quantitative indices of the present function.
  Table 1 of Legendre &amp; De Cáceres (2013) shows the incidence-based
  (presence-absence-based) indices computed by the various indices using
  binary data. <br><br> The Euclidean distance computed on untransformed
  presence-absence or abundance data produces non-informative and incorrect
  ordinations, as shown in Legendre &amp; Legendre (2012, p. 300) and in Legendre
  &amp; De Cáceres (2013). However, the Euclidean distance computed on
  log-transformed abundance data produces meaningful ordinations in principal
  coordinate analysis (PCoA). Nonetheless, it is easier to compute a PCA of
  log-transformed abundance data instead of a PCoA; the resulting ordination
  with scaling 1 will be meaningful. Messages are printed to the R console
  indicating the Euclidean status of the computed dissimilarity matrices.
  Note that for the chi-square distance, the columns that sum to zero are
  eliminated before calculation of the distances, thus preventing divisions
  by zero in the calculation of the chi-square transformation.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Chao, A., R. L. Chazdon, R. K. Colwell and T. J. Shen. 2006.
  Abundance-based similarity indices and their estimation when there are
  unseen species in samples. Biometrics 62: 361-371.</p>
<p>Legendre, P. and D. Borcard. 2018. Box-Cox-chord transformations for
  community composition data prior to beta diversity analysis. Ecography 41:
  1820-1824.</p>
<p>Legendre, P. and M. De Cáceres. 2013. Beta diversity as the variance of
  community data: dissimilarity coefficients and partitioning. Ecology
  Letters 16: 951-963.</p>
<p>Legendre, P. and E. D. Gallagher, E.D. 2001. Ecologically meaningful
  transformations for ordination of species data. Oecologia 129: 271-280.</p>
<p>Legendre, P. and Legendre, L. 2012. Numerical Ecology. 3rd English edition.
  Elsevier Science BV, Amsterdam.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Pierre Legendre <a href="mailto:pierre.legendre@umontreal.ca">pierre.legendre@umontreal.ca</a> and Naima Madi</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://github.com/vegandevs/vegan" class="external-link">"vegan"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mite</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mat1</span>  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">mite</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span><span class="op">)</span>   <span class="co"># No column has a sum of 0</span></span></span>
<span class="r-in"><span><span class="va">mat2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">mite</span><span class="op">[</span><span class="fl">61</span><span class="op">:</span><span class="fl">70</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">15</span><span class="op">]</span><span class="op">)</span>   <span class="co"># 7 of the 15 columns have a sum of 0</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Example 1: compute Hellinger distance for mat1</span></span></span>
<span class="r-in"><span><span class="va">D.out</span> <span class="op">=</span> <span class="fu">dist.ldc</span><span class="op">(</span><span class="va">mat1</span>,<span class="st">"hellinger"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Example 2: compute chi-square distance for mat2</span></span></span>
<span class="r-in"><span><span class="va">D.out</span> <span class="op">=</span> <span class="fu">dist.ldc</span><span class="op">(</span><span class="va">mat2</span>,<span class="st">"chisquare"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Example 3: compute percentage difference dissimilarity for mat2</span></span></span>
<span class="r-in"><span><span class="va">D.out</span> <span class="op">=</span> <span class="fu">dist.ldc</span><span class="op">(</span><span class="va">mat2</span>,<span class="st">"percentdiff"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Info -- This coefficient is Euclidean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Info -- This coefficient is Euclidean</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Info -- For this coefficient, sqrt(D) would be Euclidean</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stéphane Dray, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

