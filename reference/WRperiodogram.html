<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Whittaker-Robinson periodogram — WRperiodogram • adespatial</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Whittaker-Robinson periodogram — WRperiodogram"><meta property="og:description" content="Whittaker-Robinson periodogram for univariate series of quantitative data."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-23</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/adeverse/adespatial/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Whittaker-Robinson periodogram</h1>
    <small class="dont-index">Source: <a href="https://github.com/adeverse/adespatial/blob/master/R/WRperiodogram.R" class="external-link"><code>R/WRperiodogram.R</code></a></small>
    <div class="hidden name"><code>WRperiodogram.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Whittaker-Robinson periodogram for univariate series of quantitative data.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">WRperiodogram</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  T1 <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  <span class="va">T2</span>,</span>
<span>  nperm <span class="op">=</span> <span class="fl">999</span>,</span>
<span>  <span class="va">nopermute</span>,</span>
<span>  mult <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sidak"</span>, <span class="st">"bonferroni"</span><span class="op">)</span>,</span>
<span>  print.time <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'WRperio'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, prog <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, line.col <span class="op">=</span> <span class="st">"red"</span>, main <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A vector of quantitative values, with class <code>numeric</code>, for
function <code>WRperiodogram</code>, or an output object of WRperiodogram for
function <code>plot</code>.</p></dd>


<dt id="arg-t-">T1<a class="anchor" aria-label="anchor" href="#arg-t-"></a></dt>
<dd><p>First period included in the calculation (default: <code>T1=2</code>).</p></dd>


<dt id="arg-t-">T2<a class="anchor" aria-label="anchor" href="#arg-t-"></a></dt>
<dd><p>Last period included in the calculation (default: <code>T2=n/2</code>).</p></dd>


<dt id="arg-nperm">nperm<a class="anchor" aria-label="anchor" href="#arg-nperm"></a></dt>
<dd><p>Number of permutations for the tests of significance.</p></dd>


<dt id="arg-nopermute">nopermute<a class="anchor" aria-label="anchor" href="#arg-nopermute"></a></dt>
<dd><p>List of item numbers that should not be permuted; see
Details (default: no items should be excluded from the permutations).</p></dd>


<dt id="arg-mult">mult<a class="anchor" aria-label="anchor" href="#arg-mult"></a></dt>
<dd><p>Correction method for multiple testing. Choices are "bonferroni"
and "sidak" (default: <code>mult="bonferroni"</code>).</p></dd>


<dt id="arg-print-time">print.time<a class="anchor" aria-label="anchor" href="#arg-print-time"></a></dt>
<dd><p>Print the computation time. Useful when planning the
analysis of a long data series with a high number of permutations. Default:
<code>print.time=FALSE</code>.</p></dd>


<dt id="arg-prog">prog<a class="anchor" aria-label="anchor" href="#arg-prog"></a></dt>
<dd><p><code>prog=1</code> (default): use the original p-values in the plot.
<code>prog=2</code>: use the p-values corrected for multiple testing.
<code>prog=3</code>: progressive correction of the multiple tests.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Significance level for the plot; p-values smaller than or equal
to alpha are represented by black symbols. Default: <code>alpha=0.05</code>.</p></dd>


<dt id="arg-line-col">line.col<a class="anchor" aria-label="anchor" href="#arg-line-col"></a></dt>
<dd><p>Colour of the lines between symbols in the graph (default:
<code>line.col="red"</code>).</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>Main title of the plot. Users can write a custom title, in quotes
(default: <code>main="WR Periodogram"</code>).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other graphical arguments passed to this function.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The function produces an object of class <code>WRperio</code> containing a
  table with the following columns:</p>
<p></p>
<dl><dt>Period</dt>
<dd><p>period number;</p></dd>
 <dt>WR.stat</dt>
<dd><p>periodogram statistic;</p></dd>

  <dt>p-value</dt>
<dd><p>p-value after permutation test;</p></dd>
 <dt>p.corrected</dt>
<dd><p>p-value corrected for multiple tests, using the Bonferroni or Sidak method;</p></dd>
 <dt>p.corr.prog</dt>
<dd><p>p-value after progressive correction.</p></dd>


</dl><p>When the p-values cannot be computed because of a very high proportion of
  missing values in the data, values of 99 are posted in the last three
  columns of the output table.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The Whittaker-Robinson periodogram (Whittaker and Robinson, 1924) identifies
periodic components in a vector of quantitative data. The data series must
contain equally-spaced observations (i.e. constant lag) along a transect in
space or through time. The vector may contain missing observations,
represented by NA, in reasonable amount, e.g. up to a few percent of the
total number of observations. The periodogram statistic used in this function
is the standard deviation of the means of the columns of the Buys-Ballot
table (Enright, 1965). The method is also described in Legendre &amp; Legendre
(2012, Section 12.4.1). Missing values (NA) are handled by skipping the NA
values when computing the column means of the Buys-Ballot table.</p>
<p>The data must be stationary before computation of the periodogram.
Stationarity is violated when there is a trend in the data or when they were
obtained under contrasting environmental or experimental conditions. Users
should at least test for the presence of a significant linear trend in the
data (using linear regression); if a significant trend is identified, it can
be removed by computing regression residuals.</p>
<p>The <code>nopermute</code> option allows users to include a list of items numbers
that should not be permuted, whether the observations are NA or zero values.
This option should not be used in routine work. It is intended for special
situations where observations could not be made at some points along the
space or time series because that was impossible. For example, in a spatial
data series along a river, if points fall on emerging rocks or on islands, no
observation of phytoplankton could have been made at those points. For the
permutation test, values at these positions (NA or 0) should not be permuted
with values at points where observations were possible.</p>
<p>The graph produced by the <code>plot</code> function shows the periodogram
statistics and their significance following a permutation test, with periods
in the abscissa. The p-values may be corrected for multiple testing using
either the Bonferroni or the Sidak correction, which can be applied to all
values in the correlogram uniformly, or following a progressive correction.</p>
<p>A progressive correction means that for the first periodogram statistic, the
p-value is tested against the alpha significance level without any
correction; for the second statistic, the p-value is corrected for 2
simultaneous tests; and so forth until the k-th statistic, where the p-value
is corrected for k simultaneous tests. This approach solves the problem of
"where to stop interpreting a periodogram"; one goes on as long as
significant values emerge, considering the fact that the tests become
progressively more conservative.</p>
<p>In the Whittaker-Robinson periodogram, harmonics of a basic period are often
found to be also significant.</p>
<p>The permutation tests, which can take a bit of time in very large jobs, can
be interrupted by issuing an <code>Escape</code> command. One can also click the
<code>STOP</code> button at the top of the R console.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Enright, J. T. 1965. The search for rhythmicity in biological time-series.
Journal of Theoretical Biology 8: 426-468.</p>
<p>Legand, M. 1958. Variations diurnes du zooplancton autour de la Nouvelle-Calédonie.
O.R.S.T.O.M., Inst. Fr. Océanie Sect. Océanogr. Rapp. Sci. (6): 1-42.</p>
<p>Legendre, P. and L. Legendre. 2012. Numerical ecology, 3rd English edition.
Elsevier Science BV, Amsterdam.</p>
<p>Sarrazin, J., D. Cuvelier, L. Peton, P. Legendre and P. M. Sarradin. 2014.
High-resolution dynamics of a deep-sea hydrothermal mussel assemblage
monitored by the EMSO-Açores MoMAR observatory. Deep-Sea Research I 90:
62-75. (Recent application in oceanography)</p>
<p>Whittaker, E. T. and G. Robinson. 1924. The calculus of observations - A
treatise on numerical mathematics. Blackie &amp; Son, London.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Pierre Legendre <a href="mailto:pierre.legendre@umontreal.ca">pierre.legendre@umontreal.ca</a> and Guillaume
  Guenard</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span> </span></span>
<span class="r-in"><span><span class="co">### 1. Numerical example from Subsection 12.4.1 of Legendre and Legendre (2012)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">7</span>,<span class="fl">10</span>,<span class="fl">5</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">8</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">9</span>,<span class="fl">6</span>,<span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Periodogram with permutation tests of significance</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">WRperiodogram</span><span class="op">(</span><span class="va">test.vec</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span> <span class="co"># Plot the periodogram</span></span></span>
<span class="r-plt img"><img src="WRperiodogram-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### 2. Simulated data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate a data series with periodic component using Legand's (1958) equation.</span></span></span>
<span class="r-in"><span><span class="co"># Ref. Legendre and Legendre (2012, eq. 12.8, p. 753)</span></span></span>
<span class="r-in"><span><span class="co"># x = time points, T = generated period, c = shift of curve, left (+) or right (-)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">periodic.component</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">T</span>,<span class="va">c</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">/</span><span class="cn">T</span><span class="op">)</span><span class="op">*</span><span class="op">(</span><span class="va">x</span><span class="op">+</span><span class="va">c</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span>   <span class="co"># corresponds to 125 days with 4 observations per day</span></span></span>
<span class="r-in"><span><span class="co"># Generate a lunar cycle, 29.5 days (T=118)</span></span></span>
<span class="r-in"><span><span class="va">moon</span> <span class="op">&lt;-</span> <span class="fu">periodic.component</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fl">118</span>, <span class="fl">59</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Generate a circadian cycle (T=4)</span></span></span>
<span class="r-in"><span><span class="va">daily</span> <span class="op">&lt;-</span> <span class="fu">periodic.component</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fl">4</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Generate an approximate tidal cycle (T=2)</span></span></span>
<span class="r-in"><span><span class="co"># A real tidal signal would have a period of 12.42 h</span></span></span>
<span class="r-in"><span><span class="va">tide</span> <span class="op">&lt;-</span> <span class="fu">periodic.component</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span>, <span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Periodogram of the lunar component only </span></span></span>
<span class="r-in"><span><span class="va">res.moon.250</span> <span class="op">&lt;-</span> <span class="fu">WRperiodogram</span><span class="op">(</span><span class="va">moon</span>, nperm<span class="op">=</span><span class="fl">0</span><span class="op">)</span>  <span class="co"># T1=2, T2=n/2=250; no test</span></span></span>
<span class="r-in"><span><span class="va">res.moon.130</span> <span class="op">&lt;-</span> <span class="fu">WRperiodogram</span><span class="op">(</span><span class="va">moon</span>, T2<span class="op">=</span><span class="fl">130</span>, nperm<span class="op">=</span><span class="fl">499</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot 2 moon cycles, n = 118*2 = 236 points</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">moon</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">236</span><span class="op">]</span>, xlab<span class="op">=</span><span class="st">"One time unit = 6 hours"</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.moon.130</span>, prog<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co"># Plot the periodogram</span></span></span>
<span class="r-plt img"><img src="WRperiodogram-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add the daily and tidal components, plus a random normal error. With daily (T=4) and </span></span></span>
<span class="r-in"><span><span class="co"># tide (T=2), period 4 and its harmonics should have a higher W statistic than period 2</span></span></span>
<span class="r-in"><span><span class="va">var1</span> <span class="op">&lt;-</span> <span class="va">daily</span> <span class="op">+</span> <span class="va">tide</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot a portion (40 points) of the data series</span></span></span>
<span class="r-in"><span><span class="co"># Two periodic components identifiable. Tide (T=2) reinforces the daily signal (T=4)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">var1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span><span class="op">]</span>, pch<span class="op">=</span><span class="st">"."</span>, cex<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">"One time unit = 6 hours"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">var1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">40</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Periodogram of 'var'</span></span></span>
<span class="r-in"><span><span class="va">res.var1</span> <span class="op">&lt;-</span> <span class="fu">WRperiodogram</span><span class="op">(</span><span class="va">var1</span>, T2<span class="op">=</span><span class="fl">40</span>, nperm<span class="op">=</span><span class="fl">499</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.var1</span>, prog<span class="op">=</span><span class="fl">3</span>, line.col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="co"># Plot the periodogram</span></span></span>
<span class="r-plt img"><img src="WRperiodogram-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># The progressive correction for multiple tests (prog=3) was used in the periodogram.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add the three components, plus a random normal error term</span></span></span>
<span class="r-in"><span><span class="co"># to show that the WRperiodogram can test several periodic components at the same time.</span></span></span>
<span class="r-in"><span><span class="co"># (5*moon) makes the lunar periods stronger than the daily and tidal periods</span></span></span>
<span class="r-in"><span><span class="va">var2</span> <span class="op">&lt;-</span> <span class="fl">5</span><span class="op">*</span><span class="va">moon</span> <span class="op">+</span> <span class="va">daily</span> <span class="op">+</span> <span class="va">tide</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot a portion (150 points) of the data series</span></span></span>
<span class="r-in"><span><span class="co"># The three periodic components are identifiable</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">var2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">150</span><span class="op">]</span>, pch<span class="op">=</span><span class="st">"."</span>, cex<span class="op">=</span><span class="fl">1</span>, xlab<span class="op">=</span><span class="st">"One time unit = 6 hours"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">var2</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">150</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Periodogram of 'var'</span></span></span>
<span class="r-in"><span><span class="va">res.var2</span> <span class="op">&lt;-</span> <span class="fu">WRperiodogram</span><span class="op">(</span><span class="va">var2</span>, T2<span class="op">=</span><span class="fl">130</span>, nperm<span class="op">=</span><span class="fl">499</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.var2</span>, prog<span class="op">=</span><span class="fl">1</span>, line.col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span> <span class="co"># Plot the periodogram</span></span></span>
<span class="r-plt img"><img src="WRperiodogram-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Find the position of the maximum W statistic value in this periodogram</span></span></span>
<span class="r-in"><span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">res.var2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">res.var2</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 118</span>
<span class="r-in"><span><span class="co"># "-1" correction at the end of the previous line: the first computed period is T=2, </span></span></span>
<span class="r-in"><span><span class="co"># so period #118 is on line #117 of file res.var2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Illustration that the WR periodogram can handle missing values:</span></span></span>
<span class="r-in"><span><span class="co"># Replace 10% of the 500 data by NA</span></span></span>
<span class="r-in"><span><span class="va">select</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">var.na</span> <span class="op">&lt;-</span> <span class="va">var2</span></span></span>
<span class="r-in"><span><span class="va">var.na</span><span class="op">[</span><span class="va">select</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">res.var.na</span> <span class="op">&lt;-</span> <span class="fu">WRperiodogram</span><span class="op">(</span><span class="va">var.na</span>, T2<span class="op">=</span><span class="fl">130</span>, nperm<span class="op">=</span><span class="fl">499</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot the periodogram with no correction for multiple tests</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.var.na</span>, prog<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot periodogram again with progressive correction for multiple tests</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res.var.na</span>, prog<span class="op">=</span><span class="fl">3</span><span class="op">)</span> </span></span>
<span class="r-plt img"><img src="WRperiodogram-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#####</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### 3. Data used in the examples of the documentation file of function afc() of {stats}</span></span></span>
<span class="r-in"><span><span class="co"># Data file "ldeaths"; time series, 6 years x 12 months of deaths in UK hospitals</span></span></span>
<span class="r-in"><span><span class="co"># First, examine the data file ldeaths. Then:</span></span></span>
<span class="r-in"><span><span class="va">ld.res.perio</span> <span class="op">&lt;-</span> <span class="fu">WRperiodogram</span><span class="op">(</span><span class="va">ldeaths</span>, nperm<span class="op">=</span><span class="fl">499</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Plot the periodogram with two types of corrections for multiple tests</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ld.res.perio</span>, prog<span class="op">=</span><span class="fl">1</span><span class="op">)</span> <span class="co"># No correction for multiple testing</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ld.res.perio</span>, prog<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="co"># Progressive correction for multiple tests</span></span></span>
<span class="r-plt img"><img src="WRperiodogram-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># The yearly cycle and harmonics are significant</span></span></span>
<span class="r-in"><span><span class="co"># Compare the results of afc() to those of WRperiodogram above</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html" class="external-link">acf</a></span><span class="op">(</span><span class="va">ldeaths</span><span class="op">)</span>   <span class="co"># lag=1.0 is one year; see ?acf</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="WRperiodogram-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stéphane Dray, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

