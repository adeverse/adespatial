<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Moran spectral randomization for variation partitioning — msr.varipart • adespatial</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Moran spectral randomization for variation partitioning — msr.varipart"><meta property="og:description" content="The functions allows to evaluate the significance and estimate parts in
variation partitioning using Moran Spectral Randomization (MSR) as a
spatially-constrained null model to account for spatial autocorrelation in
table X. Hence, this function provides a variation partioning adujsted for
spurious correlation due to spatial autocorrelation in both the response and
one explanatory matrix."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-25</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/adeverse/adespatial/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Moran spectral randomization for variation partitioning</h1>
    <small class="dont-index">Source: <a href="https://github.com/adeverse/adespatial/blob/master/R/msr.varipart.R" class="external-link"><code>R/msr.varipart.R</code></a></small>
    <div class="hidden name"><code>msr.varipart.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The functions allows to evaluate the significance and estimate parts in
variation partitioning using Moran Spectral Randomization (MSR) as a
spatially-constrained null model to account for spatial autocorrelation in
table X. Hence, this function provides a variation partioning adujsted for
spurious correlation due to spatial autocorrelation in both the response and
one explanatory matrix.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'varipart'</span></span>
<span><span class="fu"><a href="msr.html">msr</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">listwORorthobasis</span>,</span>
<span>  nrepet <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">test</span><span class="op">$</span><span class="va">rep</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pair"</span>, <span class="st">"triplet"</span>, <span class="st">"singleton"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object generated by the <code>varipart</code> function.</p></dd>


<dt id="arg-listwororthobasis">listwORorthobasis<a class="anchor" aria-label="anchor" href="#arg-listwororthobasis"></a></dt>
<dd><p>an object of the class <code>listw</code> (spatial weights)
created by the functions of the <span class="pkg">spdep</span> package or an object of class
<code>orthobasis</code></p></dd>


<dt id="arg-nrepet">nrepet<a class="anchor" aria-label="anchor" href="#arg-nrepet"></a></dt>
<dd><p>an <code>integer</code> indicating the number of replicates</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>an character specifying which algorithm should be used to
produce spatial replicates (see <code><a href="msr.html">msr.default</a></code>).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>further arguments of the <code><a href="msr.html">msr.default</a></code> function.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of class <code>varipart</code> randomized replicates.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function corrects the biases due to spatial autocorrelation by
 using MSR procedure to produce environmental predictors that preserve the
 spatial autocorrelation and the correlation structures of the original
 environmental variables while being generated independently of species
 distribution.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Clappe, S., Dray S. and P.R. Peres-Neto (2018) Beyond
neutrality: disentangling the effects of species sorting and spurious
correlations in community analysis. Ecology 99:1737-1747.</p>
<p>Wagner, H. H., and S. Dray (2015). Generating spatially constrained null models
for irregularly spaced data using Moran spectral randomization methods.
Methods in Ecology and Evolution 6:1169-1178.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="msr.html">msr.default</a></code>, <code><a href="https://adeverse.github.io/ade4/reference/varipart.html" class="external-link">varipart</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>(s) Stephane Dray <a href="mailto:stephane.dray@univ-lyon1.fr">stephane.dray@univ-lyon1.fr</a> and Sylvie
Clappe <a href="mailto:sylvie.clappe@univ-lyon1.fr">sylvie.clappe@univ-lyon1.fr</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://adeverse.github.io/ade4/" class="external-link">ade4</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/spdep/" class="external-link">spdep</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mafragh</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## Performing standard variation partitioning</span></span></span>
<span class="r-in"><span><span class="va">dudiY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://adeverse.github.io/ade4/reference/dudi.pca.html" class="external-link">dudi.pca</a></span><span class="op">(</span><span class="va">mafragh</span><span class="op">$</span><span class="va">flo</span>, scannf <span class="op">=</span> <span class="cn">FALSE</span>, scale <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mafragh.lw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/spdep/reference/nb2listw.html" class="external-link">nb2listw</a></span><span class="op">(</span><span class="va">mafragh</span><span class="op">$</span><span class="va">nb</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="mem.html">mem</a></span><span class="op">(</span><span class="va">mafragh.lw</span>, MEM.autocor <span class="op">=</span> <span class="st">"positive"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vprda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://adeverse.github.io/ade4/reference/varipart.html" class="external-link">varipart</a></span><span class="op">(</span><span class="va">dudiY</span>, <span class="va">mafragh</span><span class="op">$</span><span class="va">env</span>, <span class="va">me</span>, type <span class="op">=</span> <span class="st">"parametric"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Adjust estimation and compute p-value by msr methods</span></span></span>
<span class="r-in"><span><span class="va">vprda.msr</span> <span class="op">&lt;-</span> <span class="fu"><a href="msr.html">msr</a></span><span class="op">(</span><span class="va">vprda</span>, <span class="va">mafragh.lw</span>, nrepet<span class="op">=</span><span class="fl">99</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">vprda.msr</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Variation Partitioning</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> class: varipart list </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test of fractions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Monte-Carlo test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call: msr.varipart(x = vprda, listwORorthobasis = mafragh.lw, nrepet = 99)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Observation: 0.2366554 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Based on 99 replicates</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulated p-value: 0.01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alternative hypothesis: greater </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Std.Obs  Expectation     Variance </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2.7025303269 0.1741019567 0.0005357487 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Individual fractions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          a          b          c          d </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.06295763 0.17369775 0.42438794 0.33895668 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Adjusted fractions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           a           b           c           d </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.01383251  0.08957240  0.25646533  0.66779478 </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stéphane Dray, Aurélie Siberchicot.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

