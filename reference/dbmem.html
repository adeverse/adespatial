<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>dbMEM spatial eigenfunctions — dbmem • adespatial</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="dbMEM spatial eigenfunctions — dbmem"><meta property="og:description" content="Compute distance-based Moran's eigenvector maps (dbMEM, also called dbMEM
spatial eigenfunctions) from a geographic distance matrix, in view of spatial
eigenfunction analysis."><meta property="og:image" content="/logo.svg"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">adespatial</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3-18</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/tutorial.html">Moran's Eigenvector Maps and related methods for the spatial multiscale analysis of ecological data</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/sdray/adespatial/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>dbMEM spatial eigenfunctions</h1>
    <small class="dont-index">Source: <a href="https://github.com/sdray/adespatial/blob/HEAD/R/dbmem.R" class="external-link"><code>R/dbmem.R</code></a></small>
    <div class="hidden name"><code>dbmem.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute distance-based Moran's eigenvector maps (dbMEM, also called dbMEM
spatial eigenfunctions) from a geographic distance matrix, in view of spatial
eigenfunction analysis.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">dbmem</span><span class="op">(</span></span>
<span>  <span class="va">xyORdist</span>,</span>
<span>  thresh <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  MEM.autocor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"positive"</span>, <span class="st">"non-null"</span>, <span class="st">"all"</span>, <span class="st">"negative"</span><span class="op">)</span>,</span>
<span>  store.listw <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>xyORdist</dt>
<dd><p>Either a matrix of spatial coordinates or a distance matrix
(class <code>dist</code>).</p></dd>


<dt>thresh</dt>
<dd><p>A threshold value for truncation of the geographic distance
matrix. If <code>thresh=NULL</code>, the length of the longest edge of the minimum
spanning tree will be used as the threshold (as returned by the function
<code>give.thresh</code>).</p></dd>


<dt>MEM.autocor</dt>
<dd><p>A string indicating if all MEMs must be returned or only
those corresponding to non-null, positive or negative autocorrelation. The
difference between options <code>all</code> and <code>non-null</code> is the following:
when there are several null eigenvalues, option <code>all</code> removes only one
of the eigenvectors with null eigenvalues and returns (n-1) eigenvectors,
whereas <code>non-null</code> does not return any of the eigenvectors with null
eigenvalues. Default: <code>MEM.autocor="positive"</code>.</p></dd>


<dt>store.listw</dt>
<dd><p>A logical indicating if the spatial weighting matrix should
be stored in the attribute <code>listw</code> of the returned object</p></dd>


<dt>silent</dt>
<dd><p>A logical indicating if some information should be printed
during computation: truncation level and time to compute the dbmem</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>An object of class <code>orthobasisSp</code> , subclass <code>orthobasis</code>.
 The dbMEM eigenfunctions (principal coordinates of the truncated distance
 matrix) are stored as a <code>data.frame</code>. It contains several attributes
 (see <code><a href="https://rdrr.io/r/base/attributes.html" class="external-link">?attributes</a></code>) including:</p><ul><li><p><code>listw</code>: The associated spatial weighting matrix (if
 <code>store.listw = TRUE</code>).</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>dbMEM eigenfunctions were called PCNM in early papers (Borcard and
 Legendre 2002, Borcard et al. 2004). There is a small difference in the
 computation: to construct PCNMs, the distance matrix subjected to PCoA
 contained zeros on the diagonal. In dbMEM, the matrix contains 4*thresh
 values on the diagonal. The result is that the dbMEM eigenvalues are smaller
 than the PCNM eigenvalues by a constant (equal to (n.sites *
 (4*thresh)^2)/2). The dbMEM eigenvalues are proportional to Moran's I
 coefficient of spatial correlation (Dray et al. 2006; Legendre and Legendre
 2012). The dbMEM eigenvectors only differ from the PCNM eigenvectors by a
 multiplicative constant; this has no impact on the use of MEMs as
 explanatory variables in linear models. In this implementation, dbMEM
 eigenvectors have a norm equal to 1 (using the uniform weigts 1/n.sites).</p>
<p>If a truncation value is not provided, the largest distance in a minimum
 spanning tree linking all sites on the map is computed (returned by the
 function <code>give.thresh</code>). That value is used as the truncation threshold
 value (thresh).</p>
<p>A square regular grid produces multiple eigenvalues (i.e. eigenvalues that
 are equal) and multiple eigenvalues have an infinity of eigenvector
 solutions. Hence, different eigenvectors may be produced by this function on
 computers with different operating systems or implementations of R. In
 addition, the eigenvectors found by the dbmem function from the site
 coordinates may differ from the eigenvectors computed from the geographic
 distance matrix among the sites. Nonetheless, the different complete sets of
 eigenvectors will have the exact same explanatory power (R-square) for a
 given response vector or matrix, despite the fact that they are not fully
 correlated on a one-to-one basis. This is, however, not the case for subsets
 of eigenvectors selected using stepwise procedures.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Borcard, D. and P. Legendre. 2002. All-scale spatial analysis of ecological
data by means of principal coordinates of neighbour matrices. Ecological
Modelling 153: 51-68.</p>
<p>Borcard, D., P. Legendre, C. Avois-Jacquet and H. Tuomisto. 2004. Dissecting
the spatial structure of ecological data at multiple scales. Ecology 85:
1826-1832.</p>
<p>Dray, S., P. Legendre and P. R. Peres-Neto. 2006. Spatial modelling: a
comprehensive framework for principal coordinate analysis of neighbour
matrices (PCNM). Ecological Modelling 196: 483-493.</p>
<p>Legendre, P. and L. Legendre. 2012. Numerical ecology, 3rd English edition.
Elsevier Science BV, Amsterdam.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="give.thresh.html">give.thresh</a></code>, <code><a href="mem.html">mem</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Stéphane Dray <a href="mailto:stephane.dray@univ-lyon1.fr">stephane.dray@univ-lyon1.fr</a>, Pierre Legendre,
 Daniel Borcard and F. Guillaume Blanchet</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">"ade4"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;</span> <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">"adegraphics"</a></span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">oribatid</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mite</span> <span class="op">&lt;-</span> <span class="va">oribatid</span><span class="op">$</span><span class="va">fau</span>      <span class="co"># 70 peat cores, 35 species</span></span></span>
<span class="r-in"><span><span class="va">mite.xy</span> <span class="op">&lt;-</span> <span class="va">oribatid</span><span class="op">$</span><span class="va">xy</span>    <span class="co"># Geographic coordinates of the 70 cores</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Compute the MEMs corresponding to all non-null eigenvalues</span></span></span>
<span class="r-in"><span><span class="co"># thresh=1.012 is the value used in Borcard and Legendre (2002)</span></span></span>
<span class="r-in"><span><span class="va">mite.dbmem1</span> <span class="op">&lt;-</span> <span class="fu">dbmem</span><span class="op">(</span><span class="va">mite.xy</span>, thresh<span class="op">=</span><span class="fl">1.012</span>, MEM.autocor <span class="op">=</span> <span class="st">"non-null"</span>, silent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mite.dbmem1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print the (n-1) non-null eigenvalues</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">mite.dbmem1</span><span class="op">)</span><span class="op">$</span><span class="va">values</span></span></span>
<span class="r-in"><span><span class="co"># or:  attr(mite.dbmem1, "values")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the associated spatial weighting matrix</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.label.html" class="external-link">s.label</a></span><span class="op">(</span><span class="va">mite.xy</span>, nb <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">mite.dbmem1</span>, <span class="st">"listw"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot maps of the first 3 dbMEM eigenfunctions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/pkg/ade4/man/s.value.html" class="external-link">s.value</a></span><span class="op">(</span><span class="va">mite.xy</span>, <span class="va">mite.dbmem1</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute and test associated Moran's I values</span></span></span>
<span class="r-in"><span><span class="co"># Eigenvalues are proportional to Moran's I</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="moran.randtest.html">moran.randtest</a></span><span class="op">(</span><span class="va">mite.dbmem1</span>, nrepet <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">obs</span>, <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">mite.dbmem1</span>, <span class="st">"values"</span><span class="op">)</span>, xlab <span class="op">=</span> <span class="st">"Moran's I"</span>, ylab <span class="op">=</span> <span class="st">"Eigenvalues"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Decreasing values of Moran's I for the successive MEM.</span></span></span>
<span class="r-in"><span><span class="co"># The red line is the expected value of Moran's I under H0.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">obs</span>, xlab<span class="op">=</span><span class="st">"MEM rank"</span>, ylab<span class="op">=</span><span class="st">"Moran's I"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mite.xy</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Compute only the MEMs with positive eigenvalues (and positive Moran's I)</span></span></span>
<span class="r-in"><span><span class="va">mite.dbmem2</span> <span class="op">&lt;-</span> <span class="fu">dbmem</span><span class="op">(</span><span class="va">mite.xy</span>, thresh<span class="op">=</span><span class="fl">1.012</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># or:  mite.dbmem2 &lt;- dbmem(dist(mite.xy), thresh=1.012, silent=FALSE)</span></span></span>
<span class="r-in"><span><span class="va">mite.dbmem2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examine the eigenvalues</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">mite.dbmem2</span><span class="op">)</span><span class="op">$</span><span class="va">values</span></span></span>
<span class="r-in"><span><span class="co"># or:  attr(mite.dbmem2, "values")</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examine (any portion of) the dbmem spatial eigenvectors</span></span></span>
<span class="r-in"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">mite.dbmem2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tmp</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> User-provided truncation threshold = 1.012 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Time to compute dbMEMs = 0.028000  sec </span>
<span class="r-plt img"><img src="dbmem-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="dbmem-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="dbmem-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="dbmem-4.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         MEM1       MEM2         MEM3        MEM4       MEM5      MEM6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  0.1620574 -0.2982476 -0.035504650  0.11383777 -0.4341443 0.2906948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  0.1947020 -0.4023768 -0.036135521 -0.03454869 -0.5620367 0.4849196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  0.2136437 -0.4890009 -0.025861763 -0.21501361 -0.6354105 0.6374601</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  0.2565198 -0.6530629 -0.009275911 -0.46957393 -0.7150526 0.7978259</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  0.2598437 -0.7327767  0.027559734 -0.77345656 -0.4832301 0.6799099</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  0.3453581 -1.0090189  0.034869125 -1.05491045 -0.8388372 1.1059744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  0.1686130 -0.3240952 -0.032762390  0.26178062 -0.6919921 0.4455021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  0.4236748 -1.3670651  0.114272484 -1.66289601 -0.4438757 0.8630065</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  0.4423362 -1.4713133  0.147573019 -1.88814315 -0.1643492 0.6274224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 0.3493720 -1.0831673  0.080660976 -1.06952479 -0.6256306 0.8238873</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stéphane Dray.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

